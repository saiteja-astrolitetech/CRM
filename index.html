<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Dairy Dashboard — Enhanced</title>
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <link href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" rel="stylesheet" />
  <style>
    :root {
      --bg: #f8fafc;
      --text: #111827;
      --card-bg: #ffffff;
      --primary: #1d4ed8;
      --border: #e5e7eb;
      --text-light: #4b5563;
      --light-gray: #f3f4f6;
    }

    .dark-mode {
      --primary: #8ab4f8;
      --primary-dark: #7ba5e6;
      --secondary: #81c995;
      --secondary-dark: #74b586;
      --accent: #f28b82;
      --accent-dark: #e07c73;
      --warning: #fdcf6b;
      --warning-dark: #f7c252;
      --light: #202124;
      --dark: #e8eaed;
      --gray: #9aa0a6;
      --light-gray: #3c4043;
      --bg: #202124;
      --card-bg: #292a2d;
      --text: #e8eaed;
      --text-light: #9aa0a6;
      --border: #3c4043;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Google Sans", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      transition: all 0.3s ease;
    }

    .page-title {
      font-size: 1.8rem;
      font-weight: 600;
    }

    .user-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text);
      font-size: 1.2rem;
    }

    /* Dashboard Cards */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 2fr));
      gap: 1.5rem;
    }

    .card-gridss {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(400px, 2fr));
      gap: 1.5rem;
      height: 500px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      border: 1px solid var(--border);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .card-title {
      font-size: 1rem;
      color: var(--text-light);
      font-weight: 500;
    }

    .card-icon {
      font-size: 1.5rem;
      padding: 0.75rem;
      border-radius: 8px;
      background: rgba(66, 133, 244, 0.1);
      color: var(--primary);
    }

    .card-value {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .card-change {
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .positive {
      color: var(--secondary);
    }

    .negative {
      color: var(--accent);
    }

    .neutral {
      color: var(--warning);
    }

    /* Charts */
    .chart-container {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border);
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .chart-title {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .chart-actions {
      display: flex;
      gap: 0.5rem;
    }

    .chart-btn {
      padding: 0.5rem 1rem;
      border-radius: 5px;
      border: 1px solid var(--border);
      background: var(--card-bg);
      cursor: pointer;
      font-size: 0.9rem;
      color: var(--text);
      transition: all 0.2s;
    }

    .chart-btn:hover {
      background: var(--light-gray);
    }

    .chart-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    canvas {
      width: 100% !important;
      height: 300px !important;
    }

    /* Data Tables */
    .data-section {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border);
      overflow-x: auto;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .section-title {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .section-actions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .btn {
      padding: 0.5rem 1rem;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
      font-size: 0.9rem;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-success {
      background: var(--secondary);
      color: white;
    }

    .btn-success:hover {
      background: var(--secondary-dark);
    }

    .btn-danger {
      background: var(--accent);
      color: white;
    }

    .btn-danger:hover {
      background: var(--accent-dark);
    }

    .btn-warning {
      background: var(--warning);
      color: var(--dark);
    }

    .btn-warning:hover {
      background: var(--warning-dark);
    }

    .btn-outline {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .btn-outline:hover {
      background: var(--light-gray);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 800px;
    }

    th,
    td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    th {
      font-weight: 600;
      color: var(--text-light);
      background: var(--light-gray);
      position: sticky;
      top: 0;
    }

    tr:hover {
      background: var(--light-gray);
    }

    .status {
      padding: 0.25rem 0.5rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      display: inline-block;
    }

    .status-active {
      background: rgba(52, 168, 83, 0.1);
      color: var(--secondary);
    }

    .status-pending {
      background: rgba(251, 188, 5, 0.1);
      color: var(--warning);
    }

    .status-inactive {
      background: rgba(234, 67, 53, 0.1);
      color: var(--accent);
    }

    .status-completed {
      background: rgba(66, 133, 244, 0.1);
      color: var(--primary);
    }

    .action-btn {
      background: none;
      border: none;
      cursor: pointer;
      margin-right: 0.5rem;
      color: var(--text-light);
      transition: color 0.2s;
      font-size: 1rem;
    }

    .action-btn:hover {
      color: var(--primary);
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: var(--card-bg);
      border-radius: 10px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 1.5rem;
      position: relative;
      border: 1px solid var(--border);
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-light);
      background: none;
      border: none;
    }

    .modal-title {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      color: var(--text);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text);
    }

    .form-control {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-radius: 5px;
      font-size: 1rem;
      background: var(--card-bg);
      color: var(--text);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary);
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
      margin-top: 1.5rem;
    }

    /* Tabs */
    .tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      margin-bottom: 1.5rem;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      color: var(--text-light);
      font-weight: 500;
      transition: all 0.2s;
    }

    .tab:hover {
      color: var(--text);
    }

    .tab.active {
      border-bottom: 3px solid var(--primary);
      font-weight: 600;
      color: var(--text);
    }

    /* Settings */
    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .setting-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border);
    }

    .setting-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text);
    }

    .setting-description {
      font-size: 0.9rem;
      color: var(--text-light);
      margin-bottom: 1.5rem;
    }

    .setting-actions {
      display: flex;
      gap: 0.5rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked+.slider {
      background-color: var(--primary);
    }

    input:checked+.slider:before {
      transform: translateX(26px);
    }

    /* Responsive */
    @media (max-width: 992px) {
      body {
        background-color: var(--bg);
        color: var(--text);
        transition: all 0.3s ease;
      }

      .sidebar {
        display: none;
      }

      .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      }

      .card-gridss {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .card-grid {
        grid-template-columns: 1fr;
      }

      .card-gridss {
        grid-template-columns: 1fr;
      }

      .section-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .section-actions {
        width: 100%;
        justify-content: flex-end;
      }
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    .fade-in {
      animation: fadeIn 0.3s ease-in-out;
    }

    /* ============ RESET & BASE ============ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Segoe UI", sans-serif;
    }

    body {
      background: var(--card-bg);
      color: var(--text);
      overflow-x: hidden;
    }

    button,
    input,
    select,
    textarea {
      font-family: inherit;
      outline: none;
    }

    /* ============ HEADER ============ */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: var(--card-bg);
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 2rem;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .hdr-left,
    .hdr-right {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .hdr-left button {
      font-size: 1.5rem;
      background: none;
      border: none;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .hdr-left button:hover {
      transform: scale(1.1);
    }

    .hdr-logo {
      height: 50px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .hdr-logo:hover {
      transform: scale(1.05);
    }

    .hdr-search {
      padding: 8px 15px;
      border-radius: 6px;
      border: 1px solid #ccc;
      min-width: 200px;
      transition: all 0.3s;
    }

    .hdr-search:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
    }

    .hdr-icon {
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.2s;
      padding: 8px;
      border-radius: 50%;
    }

    .hdr-icon:hover {
      background: var(--light-gray);
      transform: scale(1.1);
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    /* Dropdown styles */
    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: var(--card-bg);
      min-width: 160px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      z-index: 1;
      border-radius: 8px;
      padding: 8px 0;
      right: 0;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }

    .dropdown-item {
      padding: 8px 16px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .dropdown-item:hover {
      background-color: var(--light-gray);
    }

    .dropdown-btn {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 1rem;
      padding: 8px 12px;
      border-radius: 6px;
      transition: all 0.2s;
    }

    .dropdown-btn:hover {
      background-color: var(--light-gray);
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
    }

    .dot.green {
      background: #10b981;
    }

    .dot.red {
      background: #ef4444;
    }

    .dot.gray {
      background: #6b7280;
    }

    /* Profile section */
    .profile-section {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 6px;
      transition: all 0.2s;
    }

    .profile-section:hover {
      background-color: var(--light-gray);
    }

    .profile-img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--primary);
    }

    .profile-name {
      font-weight: 600;
      margin-right: 5px;
    }

    /* ============ LAYOUT ============ */
    .sidebar {
      position: fixed;
      top: 80px;
      left: 0;
      bottom: 0;
      background: linear-gradient(to right, #183adf, #553a6e);
      overflow-y: auto;
      padding: 1.5rem;
      transition: transform 0.3s ease;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    }

    .sidebar.collapsed {
      transform: translateX(-100%);
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar li {
      background: var(--card-bg);
      margin: 0.75rem 0;
      padding: 0.8rem 1rem;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }

    .sidebar li:hover {
      background: var(--light-gray);
      transform: translateX(8px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .sidebar li.active {
      background: #93c5fd;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .sidebar i {
      width: 20px;
      text-align: center;
    }

    .main {
      margin-top: 80px;
      margin-left: 280px;
      padding: 2rem;
      transition: margin-left 0.3s ease;
    }

    .main.collapsed {
      margin-left: 0 !important;
    }

    /* ============ BANNERS & SECTIONS ============ */
    .banner {
      background: linear-gradient(to right, #183adf, #553a6e);
      color: var(--card-bg);
      padding: 12px 20px;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      font-size: 1.3rem;
      font-weight: 600;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .section {
      display: none;
      padding: 0;
      margin: 0;
    }

    .section.active {
      display: block;
      padding: 0;
      margin: 0;
    }


    /* ============ CARDS GRID ============ */
    .filter-list {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .filter-list li {
      list-style: none;
      padding: 8px 16px;
      background: var(--card-bg);
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
      font-weight: 500;
    }

    .filter-list li:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      background: var(--primary);
      color: white;
    }

    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .card {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
      cursor: pointer;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
    }

    .card h3 {
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
      color: var(--primary);
    }

    .card h2 {
      font-size: 2rem;
      margin-bottom: 0.75rem;
      font-weight: 600;
    }

    .card h6 {
      font-size: 0.9rem;
      font-weight: bold;
      display: inline-block;
      padding-bottom: 3px;
      border-bottom: 3px solid #10b981;
    }

    .card h6.negative {
      border-color: #ef4444;
    }

    .card p {
      color: var(--text-light);
      margin-top: 5px;
    }

    .card-icon {
      font-size: 1.5rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    /* ============ INFO BOXES ============ */
    .row-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .info-box {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
    }

    .info-box:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }

    .info-box h4 {
      color: #1e40af;
      margin-bottom: 0.75rem;
      font-size: 1.1rem;
    }

    .info-box p {
      font-size: 1.1rem;
      font-weight: 500;
    }

    .info-box .highlight {
      background: #e8f5e9;
      padding: 8px;
      border-radius: 6px;
      margin-bottom: 8px;
    }

    .info-box .warning {
      background: var(--card-bg)3e0;
      padding: 8px;
      border-radius: 6px;
      margin-bottom: 8px;
    }

    .info-box .recommendation {
      background: #e3f2fd;
      padding: 8px;
      border-radius: 6px;
    }

    /* ============ TABLES ============ */
    .custom-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }

    .custom-table th,
    .custom-table td {
      padding: 12px 15px;
      border: 1px solid var(--border);
      text-align: left;
    }

    .custom-table th {
      background: var(--light-gray);
      font-weight: 600;
    }

    .custom-table tr:hover td {
      background: var(--bg);
    }

    .status-badge {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
      display: inline-block;
    }

    .status-completed {
      background: #d1fae5;
      color: var(--secondary-dark);
    }

    .status-pending {
      background: var(--warning);
      color: #92400e;
    }

    .status-warning {
      background: var(--accent);
      color: var(--accent-dark);
    }

    .btn {
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      background: var(--light-gray);
      color: var(--primary-dark);
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
    }

    .btn:hover {
      background: var(--light);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .btn-export {
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 8px 12px;
    }

    .btn-export:hover {
      background: var(--primary-dark);
    }

    /* ============ DIRECT SALES CARDS ============ */
    .sales-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .sales-cards .card {
      flex: 1 1 220px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .sales-cards .card h1 {
      font-size: 2.5rem;
      margin: 10px 0;
      font-weight: 600;
    }

    /* ============ ORDERS SECTION ============ */
    .orders-section {
      margin-top: 2rem;
      background: var(--card-bg);
      border-radius: 10px;
      padding: 1.5rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    .orders-section h3 {
      margin-bottom: 1rem;
      font-size: 1.5rem;
      color: var(--text);
    }

    .orders-section table {
      width: 100%;
      border-collapse: collapse;
    }

    .orders-section th,
    .orders-section td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }

    .details-btn {
      background-color: #28a745;
      color: var(--card-bg);
      border: none;
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
    }

    /* ============ PAGINATION ============ */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 0.75rem;
      margin: 2rem 0;
    }

    .pagination button {
      padding: 8px 14px;
      border: 1px solid #4f46e5;
      border-radius: 6px;
      background: var(--card-bg);
      cursor: pointer;
      transition: all 0.2s;
    }

    .pagination button:hover {
      background: #e0e7ff;
    }

    .pagination button.active {
      background: #4f46e5;
      color: white;
    }

    .page-btn {
      min-width: 40px;
    }

    /* ============ MODAL ============ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      width: 400px;
      max-width: 90%;
      text-align: center;
    }

    .modal-content button {
      margin-top: 1rem;
      background: #007BFF;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 5px;
      cursor: pointer;
    }

    /* ============ CHARTS ============ */
    .chart-container {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      margin: 2rem 0;
    }

    .chart-box {
      flex: 1;
      min-width: 350px;
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .chart-box canvas {
      width: 100% !important;
      height: 300px !important;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .chart-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--primary);
    }

    .chart-actions {
      display: flex;
      gap: 0.5rem;
    }

    /* ============ PROFILE FORM ============ */
    .profile-form {
      max-width: 500px;
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-top: 1rem;
    }

    .profile-form label {
      display: block;
      margin: 1rem 0 0.5rem;
      font-weight: 500;
      color: var(--primary);
    }

    .profile-form input,
    .profile-form textarea,
    .profile-form select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      transition: all 0.3s;
    }

    .profile-form input:focus,
    .profile-form textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }

    .profile-form button {
      margin-top: 1.5rem;
      padding: 10px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
    }

    .profile-form button:hover {
      background: var(--primary-dark);
    }

    /* ============ MAP STYLES ============ */
    #farmerMap {
      height: 400px;
      width: 100%;
      border-radius: 10px;
      margin: 1.5rem 0;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .map-container {
      position: relative;
    }

    .map-legend {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 10px;
      border-radius: 5px;
      z-index: 999;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin: 5px 0;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      border-radius: 3px;
    }

    /* ============ GAUGE STYLES ============ */
    .gauge-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin: 1.5rem 0;
    }

    .gauge {
      flex: 1;
      min-width: 200px;
      background: white;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .gauge-title {
      font-size: 1rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .gauge-value {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 0.5rem 0;
    }

    .gauge-bar {
      height: 20px;
      background: var(--border);
      border-radius: 10px;
      overflow: hidden;
      position: relative;
    }

    .gauge-fill {
      height: 100%;
      background: linear-gradient(to right, #4ade80, var(--primary));
      border-radius: 10px;
      transition: width 0.5s ease;
    }

    /* ============ ALERT STYLES ============ */
    .alert-container {
      background: white;
      border-radius: 10px;
      padding: 1.5rem;
      margin: 1.5rem 0;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .alert-item {
      display: flex;
      align-items: center;
      padding: 10px;
      margin: 5px 0;
      border-radius: 5px;
      background: var(--warning);
    }

    .alert-item.warning {
      background: var(--accent);
    }

    .alert-item.success {
      background: var(--secondary);
    }

    .alert-icon {
      margin-right: 10px;
      font-size: 1.2rem;
    }

    .alert-warning .alert-icon {
      color: #b45309;
    }

    .alert-success .alert-icon {
      color: var(--secondary-dark);
    }

    /* ============ PRODUCTION FLOW ============ */
    .flow-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: white;
      padding: 1.5rem;
      border-radius: 10px;
      margin: 1.5rem 0;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .flow-step {
      text-align: center;
      flex: 1;
      position: relative;
    }

    .flow-step:not(:last-child):after {
      content: "→";
      position: absolute;
      right: -20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.5rem;
      color: #9ca3af;
    }

    .flow-icon {
      font-size: 2rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }

    .flow-label {
      font-weight: 500;
      color: var(--primary);
    }

    /* ============ FEEDBACK STYLES ============ */
    .feedback-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin: 1.5rem 0;
    }

    .feedback-card {
      flex: 1;
      min-width: 200px;
      background: white;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .feedback-header {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .feedback-rating {
      margin-left: auto;
      color: #f59e0b;
      font-weight: bold;
    }

    .feedback-store {
      font-weight: 500;
      color: var(--primary);
    }

    .feedback-comment {
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .main {
        margin-left: 0;
        padding: 1rem;
      }

      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.collapsed {
        transform: translateX(0);
      }

      .cards-grid {
        grid-template-columns: 1fr;
      }

      .chart-container {
        flex-direction: column;
      }

      .hdr-right {
        gap: 0.5rem;
      }

      .flow-container {
        flex-direction: column;
      }

      .flow-step:not(:last-child):after {
        content: "↓";
        right: 50%;
        top: auto;
        bottom: -20px;
        transform: translateX(50%);
      }

      .flow-step {
        margin-bottom: 2rem;
      }
    }


    /* === Enhanced Dark Mode === */
    .dark-mode {
      --primary: #8ab4f8;
      --primary-dark: #5a9cf5;
      --secondary: #81c995;
      --secondary-dark: #5ca877;
      --accent: #f28b82;
      --accent-dark: #e07c73;
      --warning: #fbbc04;
      --warning-dark: #f9ab00;
      --light: #202124;
      --dark: #e8eaed;
      --gray: #9aa0a6;
      --light-gray: #3c4043;
      --bg: #121212;
      --card-bg: #1e1e1e;
      --text: #e8eaed;
      --text-light: #bdc1c6;
      --border: #3c4043;
    }

    /* Remove gradient backgrounds for dark mode */
    .dark-mode .banner,
    .dark-mode .sidebar {
      background: var(--card-bg) !important;
      color: var(--text);
    }

    /* Charts, cards, tables, modals cleanup */
    .dark-mode .card,
    .dark-mode .chart-box,
    .dark-mode .modal-content,
    .dark-mode .data-section,
    .dark-mode .info-box,
    .dark-mode .orders-section,
    .dark-mode .table-wrapper,
    .dark-mode .alert-container,
    .dark-mode .gauge,
    .dark-mode .feedback-card,
    .dark-mode .setting-card,
    .dark-mode .profile-form {
      background: var(--card-bg) !important;
      color: var(--text);
      border: 1px solid var(--border);
    }

    /* Header and input */
    .dark-mode header,
    .dark-mode input,
    .dark-mode select,
    .dark-mode textarea {
      background: var(--card-bg);
      color: var(--text);
      border-color: var(--border);
    }

    /* Buttons */
    .dark-mode .btn,
    .dark-mode .btn-export,
    .dark-mode .chart-btn,
    .dark-mode .btn-outline,
    .dark-mode .dropdown-btn,
    .dark-mode .dropdown-item,
    .dark-mode .pagination button {
      background: var(--light-gray) !important;
      color: var(--text) !important;
      border: 1px solid var(--border);
    }

    .dark-mode .btn:hover,
    .dark-mode .chart-btn:hover,
    .dark-mode .btn-outline:hover,
    .dark-mode .dropdown-btn:hover,
    .dark-mode .dropdown-item:hover,
    .dark-mode .pagination button:hover {
      background: var(--gray) !important;
    }

    /* Tabs */
    .dark-mode .tab.active {
      border-bottom: 3px solid var(--primary);
      color: var(--text);
    }

    /* Table Header */
    .dark-mode th {
      background: var(--light-gray);
      color: var(--text-light);
    }

    /* Status badges */
    .dark-mode .status-badge {
      color: inherit;
    }

    /* Modal overlays */
    .dark-mode .modal-overlay {
      background: rgba(0, 0, 0, 0.7);
    }


    .dark-mode table,
    .dark-mode thead,
    .dark-mode tbody,
    .dark-mode tr,
    .dark-mode td,
    .dark-mode th {
      background-color: var(--card-bg) !important;
      color: var(--text) !important;
      border-color: var(--border) !important;
    }

    .dark-mode table th {
      background: var(--light-gray) !important;
      color: var(--text-light) !important;
    }

    .dark-mode .pagination button {
      background: var(--light-gray) !important;
      color: var(--text);
      border: 1px solid var(--border);
    }


    header {
      background: var(--card-bg, #ffffff);
    }


    .header-dropdown,
    .language-dropdown,
    .profile-dropdown {
      background-color: var(--card-bg, #ffffff);
      color: var(--text, #111827);
      border: 1px solid var(--border, #e5e7eb);
    }
  </style>
  <style>
    .hover-lift:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }

    .btn:hover {
      transform: scale(1.02);
    }
  </style>
  <style>
    /* Dark mode visual corrections */
    .dark-mode .card,
    .dark-mode .info-box,
    .dark-mode .modal-content,
    .dark-mode .table-wrapper,
    .dark-mode .custom-table,
    .dark-mode .alert-container {
      background: var(--card-bg) !important;
      color: var(--text) !important;
      border: 1px solid var(--border);
    }

    .dark-mode .card i,
    .dark-mode .card .card-title,
    .dark-mode .card .card-value,
    .dark-mode .card .card-change {
      color: var(--text) !important;
    }

    /* Charts and cards animation */
    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-up {
      animation: fadeUp 0.5s ease-in-out both;
    }

    .card,
    .info-box,
    .chart-box {
      transition: all 0.3s ease-in-out;
    }

    /* Smooth tab transition */
    .section {
      transition: opacity 0.3s ease-in-out;
    }

    .section:not(.active) {
      opacity: 0;
      pointer-events: none;
      height: 0;
      overflow: hidden;
    }

    .section.active {
      opacity: 1;
      pointer-events: all;
      height: auto;
    }

    /* Modal overlay cleanup */
    .dark-mode .modal-overlay {
      background: rgba(0, 0, 0, 0.7);
    }
  </style>
  <style>
    /* Adjust fixed navs or headers if needed */
    body {
      font-size: 0.95rem;
    }
  </style>
  <style>
    html {
      font-size: 90%;
    }

    body {
      font-size: 0.95rem !important;
    }

    .card,
    .info-box,
    .chart-box,
    .setting-card,
    .modal-content,
    .data-section,
    .orders-section {
      padding: 1.25rem !important;
    }

    .card h2,
    .info-box h4,
    .chart-title,
    .section-title {
      font-size: 1.5rem !important;
    }

    .card-value {
      font-size: 1.6rem !important;
    }
  </style>
  <style>
    .card-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
    }

    /* Mobile responsive fallback */
    @media (max-width: 768px) {
      .card-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <style>
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
      margin-top: 1.5rem;
    }

    @media (max-width: 768px) {
      .chart-grid {
        grid-template-columns: 1fr;
      }
    }

    .chart-container canvas {
      max-width: 100%;
      height: auto;
    }
  </style>
  <style>
    /* Dark mode support for charts */
    .dark-mode .chart-container {
      background: var(--card-bg) !important;
      color: var(--text) !important;
      border: 1px solid var(--border);
    }

    /* Custom sidebar scrollbar styling */
    .sidebar::-webkit-scrollbar {
      width: 6px;
    }

    .sidebar::-webkit-scrollbar-thumb {
      background: #aaa;
      border-radius: 6px;
    }

    .sidebar::-webkit-scrollbar-thumb:hover {
      background: #777;
    }
  </style>
  <style>
    .main {
      margin-left: 250px !important;
    }
  </style>
  <style>
    .info-box {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }

    .info-box:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
    }
  </style>
  <style>
    .section-title {
      margin-top: 2.5rem !important;
      margin-bottom: 1.5rem !important;
    }

    .card-grid,
    .info-box-grid,
    .chart-grid,
    .data-section,
    .orders-section,
    .setting-card {
      margin-bottom: 2rem !important;
    }

    h4,
    .card-title {
      margin-bottom: 0.5rem;
    }

    .info-box p,
    .card-value {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1.25rem;
      margin-top: 0.25rem;
    }
  </style>
</head>

<body>
  
  <header>
    <div class="hdr-left">
      <img alt="Logo" class="hdr-logo" onclick="showSection('dashboard')" src="logo.png" />
      <button onclick="toggleSidebar()">☰</button>
      <strong>Admin Dashboard</strong>
    </div>
    <div class="hdr-right">
      <input class="hdr-search" placeholder="Search..." type="text" />
      <i class="fas fa-bell hdr-icon"></i>
      <i class="fas fa-envelope hdr-icon"></i>
      
      <div class="dropdown">
        <button class="dropdown-btn">English</button>
        <div class="dropdown-content">
          <div class="dropdown-item" onclick="setLanguage('en')">English</div>
          <div class="dropdown-item" onclick="setLanguage('hi')">Hindi</div>
          <div class="dropdown-item" onclick="setLanguage('te')">Telugu</div>
          <div class="dropdown-item" onclick="setLanguage('de')">German</div>
        </div>
      </div>
      
      <div class="dropdown">
        <button class="dropdown-btn"><span class="dot green"></span> Active</button>
        <div class="dropdown-content">
          <div class="dropdown-item" onclick="setWorkMode('active')"><span class="dot green"></span> Active</div>
          <div class="dropdown-item" onclick="setWorkMode('away')"><span class="dot gray"></span> Away</div>
          <div class="dropdown-item" onclick="setWorkMode('dnd')"><span class="dot red"></span> Do Not Disturb</div>
        </div>
      </div>
      <button class="theme-toggle" id="theme-toggle"><i class="fas fa-moon"></i></button>
      
      <div class="profile-section"
        onclick="document.querySelectorAll('.section').forEach(s=>s.classList.remove('active')); document.getElementById('profile').classList.add('active');">
        <span class="profile-name">Smith Seo</span>
        <img alt="Profile" class="profile-img" src="image.png" />
      </div>
    </div>
  </header>
  <aside class="sidebar" id="sidebar">
    <ul>
      <li class="active" onclick="activateNav(this,'dashboard')"><i class="fas fa-home"></i> Dashboard</li>
      <li onclick="activateNav(this,'farmer-mgmt')"><i class="fas fa-users"></i> Farmer Management</li>
      <li onclick="activateNav(this,'milk-collection')"><i class="fas fa-tint"></i> Milk Collection</li>
      <li onclick="activateNav(this,'chilling')"><i class="fas fa-snowflake"></i> Chilling Centers</li>
      <li onclick="activateNav(this,'processing')"><i class="fas fa-cogs"></i> Processing Plants</li>
      <li onclick="activateNav(this,'quality')"><i class="fas fa-check-circle"></i> Quality Control</li>
      <li onclick="activateNav(this,'inventory')"><i class="fas fa-boxes"></i> Product Inventory</li>
      <li onclick="activateNav(this,'logistics')"><i class="fas fa-truck"></i> Distribution &amp; Logistics</li>
      <li onclick="activateNav(this,'retail')"><i class="fas fa-store"></i> Retail &amp; Franchise</li>
      <li onclick="activateNav(this,'dashboard-section')"><i class="fas fa-chart-line"></i> Dashboard Analytics</li>
      <li onclick="activateNav(this,'customers-section')"><i class="fas fa-user-friends"></i> Customers</li>
      <li onclick="activateNav(this,'suppliers-section')"><i class="fas fa-tractor"></i> Suppliers</li>
      <li onclick="activateNav(this,'deliveries-section')"><i class="fas fa-shipping-fast"></i> Deliveries</li>
      <li onclick="activateNav(this,'payments-section')"><i class="fas fa-rupee-sign"></i> Payments</li>
      <li onclick="activateNav(this,'reports-section')"><i class="fas fa-file-alt"></i> Reports</li>
      <li onclick="activateNav(this,'settings-section')"><i class="fas fa-cog"></i> Settings</li>
    </ul>
  </aside>
  
  
  <div class="main" id="main">
    
    <div class="section active fade-in" id="dashboard">
      <div class="banner">Dashboard Overview</div>
      
      <ul class="filter-list">
        <li>Daily</li>
        <li>Weekly</li>
        <li>Monthly</li>
        <li>Custom</li>
      </ul>
      
      <div class="card-grid">
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-wine-bottle card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Total Milk Procurement</div>
            <div style="font-size: 1.8rem; font-weight: bold;">250,000 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+12.5%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-money-bill-wave card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Total Sales Revenue</div>
            <div style="font-size: 1.8rem; font-weight: bold;">₹ 1,500,000</div>
            <div style="font-size: 0.85rem; color: #dc2626;">-2%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-user-friends card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Active Farmers</div>
            <div style="font-size: 1.8rem; font-weight: bold;">5,000+</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+5.7%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-truck card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Distributors/Retailers</div>
            <div style="font-size: 1.8rem; font-weight: bold;">1,200</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+8.3%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-chart-line card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Customer Growth Rate</div>
            <div style="font-size: 1.8rem; font-weight: bold;">12%</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+12.5%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-check-circle card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Quality Metrics</div>
            <div style="font-size: 1.8rem; font-weight: bold;">95%</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+12.5%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-leaf card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Environmental Metrics</div>
            <div style="font-size: 1.8rem; font-weight: bold;">70%</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+12.5%</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-users card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Employee Engagement</div>
            <div style="font-size: 1.8rem; font-weight: bold;">90%</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+12.5%</div>
          </div>
        </div>
      </div>
      
      <div class="banner">Investment Summary</div>
      <div class="row-grid">
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Milk Purchased</h4>
          <p><i class="fas fa-tint" style="margin-right: 6px; font-size: 1rem; color: #1d4ed8;"></i>12,450 L</p>
        </div>
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Total Investment</h4>
          <p><i class="fas fa-rupee-sign" style="margin-right: 6px; font-size: 1rem; color: #1d4ed8;"></i>₹ 487,500</p>
        </div>
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Avg. Milk Price</h4>
          <p><i class="fas fa-balance-scale" style="margin-right: 6px; font-size: 1rem; color: #1d4ed8;"></i>₹ 32 /L</p>
        </div>
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Active Suppliers</h4>
          <p><i class="fas fa-tractor" style="margin-right: 6px; font-size: 1rem; color: #1d4ed8;"></i>24</p>
        </div>
      </div>
      
      <div class="banner">Top Suppliers</div>
      <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
        <thead>
          <tr>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Supplier</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Qty (L)</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Rate (₹/L)</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Green Pastures</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">1,250</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">32.00</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 40,000</td>
          </tr>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Happy Cows Dairy</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">980</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">31.00</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 30,380</td>
          </tr>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Organic Valley</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">1,500</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">34.00</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 51,000</td>
          </tr>
        </tbody>
      </table>
      
      <div class="banner">Packaging Investments</div>
      <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
        <thead>
          <tr>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Package Type</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Qty</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Cost/Unit</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">500 ml Pouch</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">5,000</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 5.20</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 26,000</td>
          </tr>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">1 L Bottle</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3,000</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 8.50</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 25,500</td>
          </tr>
        </tbody>
      </table>
      
      <div class="section fade-in" id="direct-sales">
        <div class="banner">Direct Sales</div>
        <div class="sales-cards">
          <div class="card fade-up">
            <i class="fas fa-shopping-cart card-icon"></i>
            <h3>Today's Sales</h3>
            <h1>1,245</h1>
            <p style="color: green">↑ 12% from yesterday</p>
          </div>
          <div class="card fade-up">
            <i class="fas fa-store card-icon"></i>
            <h3>Store Orders</h3>
            <h1>24</h1>
            <p style="color: green">↑ 3 new today</p>
          </div>
          <div class="card fade-up">
            <i class="fas fa-calendar-check card-icon"></i>
            <h3>Subscriptions</h3>
            <h1>156</h1>
            <p style="color: orange">↓ 2 renewals needed</p>
          </div>
          <div class="card fade-up">
            <i class="fas fa-user-plus card-icon"></i>
            <h3>New Customers</h3>
            <h1>8</h1>
            <p style="color: green">↑ 2 this week</p>
          </div>
        </div>
      </div>
      
      <div class="orders-section">
        <h3>Recent Farm Store Purchases</h3>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Order #</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Customer</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Products</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Total</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Date</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Action</th>
            </tr>
          </thead>
          <tbody id="ordersBody">
            
          </tbody>
        </table>
        <div class="pagination">
          <button onclick="changePage(1)">«</button>
          <button class="page-btn" onclick="changePage(1)">1</button>
          <button class="page-btn" onclick="changePage(2)">2</button>
          <button class="page-btn" onclick="changePage(3)">3</button>
          <button onclick="changePage(3)">»</button>
        </div>
      </div>
      
      <div class="modal-overlay" style="display: none;" id="orderModal">
        <div class="modal-content"
          style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); max-width: 500px; margin: auto;">
          <h3>Order Details</h3>
          <p id="modalOrderInfo"></p>
          <button onclick="closeModal()">Close</button>
        </div>
      </div>
      
      <div class="banner">Production Overview</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Monthly Milk Procurement</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('milkBarChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
              <button class="btn btn-export" onclick="exportChartToExcel('milkBarChart')">
                <i class="fas fa-file-excel"></i> Excel
              </button>
            </div>
          </div>
          <canvas id="milkBarChart"></canvas>
        </div>
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Investment Distribution</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('investmentPieChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
              <button class="btn btn-export" onclick="exportChartToExcel('investmentPieChart')">
                <i class="fas fa-file-excel"></i> Excel
              </button>
            </div>
          </div>
          <canvas id="investmentPieChart"></canvas>
        </div>
      </div>
      <div class="row-grid">
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Key Insights</h4>
          <p>Total Milk Purchased: <strong>12,450 L</strong></p>
          <p>Total Packaging Investment: <strong>₹ 414,900</strong></p>
          <p>Most Expensive Packaging: <strong>Ghee (₹ 170,000)</strong></p>
          <p>Highest Volume Product: <strong>Curd (13,500 units)</strong></p>
        </div>
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Monthly Trends</h4>
          <div class="highlight">
            📈 <strong>Positive:</strong> Milk purchases ↑ 5.2% vs last month
          </div>
          <div class="warning">
            ⚠️ <strong>Watch:</strong> Avg milk price ↓ 1.2%
          </div>
          <div class="recommendation">
            💡 <strong>Recommendation:</strong> Negotiate rates with top 3 suppliers
          </div>
        </div>
      </div>
    </div>
    
    <div class="section fade-in" id="farmer-mgmt">
      <div class="banner">Farmer Management</div>
      <div class="card-grid">
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-users card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Total Farmers</div>
            <div style="font-size: 1.8rem; font-weight: bold;">5,000</div>
            <div style="font-size: 0.85rem; color: #16a34a;">Registered in our system</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-user-plus card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">New Farmers (This Month)</div>
            <div style="font-size: 1.8rem; font-weight: bold;">320</div>
            <div style="font-size: 0.85rem; color: #16a34a;">+15% from last month</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-user-check card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Active This Week</div>
            <div style="font-size: 1.8rem; font-weight: bold;">3,450</div>
            <div style="font-size: 0.85rem; color: #16a34a;">69% of total farmers</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-wine-bottle card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Avg. Milk Contribution</div>
            <div style="font-size: 1.8rem; font-weight: bold;">50 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;">Per farmer per day</div>
          </div>
        </div>
      </div>
      
      <div class="banner">Farmer Distribution by Region</div>
      <div class="map-container">
        <div id="farmerMap"></div>
        <div class="map-legend">
          <div class="legend-item">
            <div class="legend-color" style="background-color: #3b82f6;"></div>
            <span>1-50 Farmers</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #10b981;"></div>
            <span>51-100 Farmers</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #f59e0b;"></div>
            <span>101-200 Farmers</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #ef4444;"></div>
            <span>200+ Farmers</span>
          </div>
        </div>
      </div>
      
      <div class="banner">Farmer Engagement Metrics</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Training Participation</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('trainingChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="trainingChart"></canvas>
        </div>
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Quality Compliance</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('qualityChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="qualityChart"></canvas>
        </div>
      </div>
      <div class="banner">Recent Farmer Registrations</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Farmer ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Name</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Location</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Join Date</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Avg. Milk (L/day)</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">F10045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Rajesh Kumar</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Village A</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">2025-03-28</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">45</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Active</span>
              </td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">F10044</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Sunil Reddy</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Village B</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">2025-03-27</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">60</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Active</span>
              </td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">F10043</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Anil Sharma</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Village C</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">2025-03-25</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">38</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-pending">Pending</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="pagination">
        <button>«</button>
        <button class="active">1</button>
        <button>2</button>
        <button>3</button>
        <button>»</button>
      </div>
    </div>
    
    <div class="section fade-in" id="milk-collection">
      <div class="banner">Milk Collection</div>
      <div class="card-grid">
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-wine-bottle card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Collected Today</div>
            <div style="font-size: 1.8rem; font-weight: bold;">12,450 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;">From all collection centers</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-calendar-alt card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Avg. Collection/Day</div>
            <div style="font-size: 1.8rem; font-weight: bold;">10,800 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;">Last 30 days average</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-check-circle card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Quality Pass Rate</div>
            <div style="font-size: 1.8rem; font-weight: bold;">95%</div>
            <div style="font-size: 0.85rem; color: #16a34a;">Of collected milk</div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-warehouse card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Collection Centers</div>
            <div style="font-size: 1.8rem; font-weight: bold;">25</div>
            <div style="font-size: 0.85rem; color: #16a34a;">Active centers</div>
          </div>
        </div>
      </div>
      
      <div class="banner">Collection Trends</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Weekly Milk Collection by Center</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('milkCollectChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
              <button class="btn btn-export" onclick="exportChartToExcel('milkCollectChart')">
                <i class="fas fa-file-excel"></i> Excel
              </button>
            </div>
          </div>
          <canvas id="milkCollectChart"></canvas>
        </div>
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Fat/SNF Analysis</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('fatSnfChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="fatSnfChart"></canvas>
        </div>
      </div>
      <div class="banner">Recent Collections</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Collection ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Center</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Farmer ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Quantity (L)</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Fat %</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">SNF %</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">C2045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Center A</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">F10045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">45</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">4.2</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8.5</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Today, 06:30 AM</td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">C2044</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Center B</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">F10032</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">38</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3.8</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8.2</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Today, 06:45 AM</td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">C2043</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Center A</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">F10028</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">52</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">4.5</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8.7</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Today, 07:15 AM</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="chilling">
      <div class="banner">Chilling Centers</div>
      <div class="card-grid">
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-warehouse card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Active Centers</div>
            <div style="font-size: 1.8rem; font-weight: bold;">15</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-boxes card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Total Capacity</div>
            <div style="font-size: 1.8rem; font-weight: bold;">50,000 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-box-open card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Current Storage</div>
            <div style="font-size: 1.8rem; font-weight: bold;">32,450 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-temperature-low card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Avg. Temperature</div>
            <div style="font-size: 1.8rem; font-weight: bold;">4°C</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
      </div>
      
      <div class="banner">Capacity Utilization</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Storage Utilization by Center</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('capacityChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="capacityChart"></canvas>
        </div>
      </div>
      
      <div class="banner">Maintenance Alerts</div>
      <div class="alert-container">
        <div class="alert-item warning">
          <i class="fas fa-exclamation-triangle alert-icon"></i>
          <div>
            <strong>Center CH1003</strong> - Scheduled maintenance tomorrow from 2-4 PM
          </div>
        </div>
        <div class="alert-item">
          <i class="fas fa-info-circle alert-icon"></i>
          <div>
            <strong>Center CH1005</strong> - Temperature sensor needs calibration
          </div>
        </div>
        <div class="alert-item success">
          <i class="fas fa-check-circle alert-icon"></i>
          <div>
            <strong>Center CH1001</strong> - Monthly maintenance completed
          </div>
        </div>
      </div>
      <div class="banner">Center Details</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Center ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Location</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Capacity (L)</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Current (L)</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Temp (°C)</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">CH1001</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Village A</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">5,000</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3,245</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">4.2</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Operational</span>
              </td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">CH1002</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Village B</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3,500</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">2,980</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3.8</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Operational</span>
              </td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">CH1003</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Village C</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">4,000</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">1,245</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">4.5</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-pending">Maintenance</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="processing">
      <div class="banner">Processing Plants</div>
      <div class="card-grid">
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-industry card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Plants Online</div>
            <div style="font-size: 1.8rem; font-weight: bold;">5</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-chart-line card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Daily Output</div>
            <div style="font-size: 1.8rem; font-weight: bold;">30,000 L</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-tachometer-alt card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Utilization</div>
            <div style="font-size: 1.8rem; font-weight: bold;">85%</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-clock card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Avg. Downtime</div>
            <div style="font-size: 1.8rem; font-weight: bold;">2%</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
      </div>
      
      <div class="banner">Production Line Overview</div>
      <div class="flow-container">
        <div class="flow-step">
          <i class="fas fa-tint flow-icon"></i>
          <div class="flow-label">Raw Milk</div>
        </div>
        <div class="flow-step">
          <i class="fas fa-filter flow-icon"></i>
          <div class="flow-label">Filtration</div>
        </div>
        <div class="flow-step">
          <i class="fas fa-temperature-high flow-icon"></i>
          <div class="flow-label">Pasteurization</div>
        </div>
        <div class="flow-step">
          <i class="fas fa-blender flow-icon"></i>
          <div class="flow-label">Processing</div>
        </div>
        <div class="flow-step">
          <i class="fas fa-box flow-icon"></i>
          <div class="flow-label">Packaging</div>
        </div>
      </div>
      
      <div class="banner">Plant Efficiency Metrics</div>
      <div class="gauge-container">
        <div class="gauge">
          <div class="gauge-title">Main Plant Utilization</div>
          <div class="gauge-value">87%</div>
          <div class="gauge-bar">
            <div class="gauge-fill" style="width: 87%"></div>
          </div>
        </div>
        <div class="gauge">
          <div class="gauge-title">North Plant Utilization</div>
          <div class="gauge-value">78%</div>
          <div class="gauge-bar">
            <div class="gauge-fill" style="width: 78%"></div>
          </div>
        </div>
        <div class="gauge">
          <div class="gauge-title">South Plant Utilization</div>
          <div class="gauge-value">65%</div>
          <div class="gauge-bar">
            <div class="gauge-fill" style="width: 65%"></div>
          </div>
        </div>
      </div>
      <div class="banner">Plant Operations</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Plant ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Location</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Capacity (L/day)</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Today's Output</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">PL1001</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Main Facility</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">10,000</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8,450</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Running</span>
              </td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">PL1002</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">North Facility</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8,000</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">7,200</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Running</span>
              </td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">PL1003</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">South Facility</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">6,000</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">5,100</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-pending">Cleaning</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="quality">
      <div class="banner">Quality Control</div>
      <div class="cards-grid">
        <div class="card-grid">
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-tint" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Total Milk Collected</div>
              <div style="font-size: 1.8rem; font-weight: bold;">24,500 L</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 3.2% Today</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-rupee-sign" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Revenue</div>
              <div style="font-size: 1.8rem; font-weight: bold;">₹ 1,200,000</div>
              <div style="font-size: 0.85rem; color: #dc2626;">↓ 1.2% This Month</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-user-check" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Active Customers</div>
              <div style="font-size: 1.8rem; font-weight: bold;">1,850</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 4.1% Growth</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-truck" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Deliveries</div>
              <div style="font-size: 1.8rem; font-weight: bold;">980</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 2.4% This Week</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="banner">Quality Test Results</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Test Result History (Last 30 Days)</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('testHistoryChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="testHistoryChart"></canvas>
        </div>
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Failure Reasons</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('failureReasonsChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="failureReasonsChart"></canvas>
        </div>
      </div>
      <div class="banner">Recent Quality Tests</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Test ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Batch</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Fat %</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">SNF %</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Acidity</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Result</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">T3045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">B10045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">4.2</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8.5</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">0.14</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Passed</span>
              </td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Today, 08:30 AM</td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">T3044</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">B10044</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3.8</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8.2</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">0.16</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Passed</span>
              </td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Today, 08:45 AM</td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">T3043</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">B10043</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3.5</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">7.9</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">0.18</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;"><span
                  class="status-badge status-pending">Failed</span></td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Today, 09:15 AM</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="inventory">
      <div class="banner">Product Inventory</div>
      <div class="cards-grid">
        <div class="card-grid">
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-tint" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Total Milk Collected</div>
              <div style="font-size: 1.8rem; font-weight: bold;">24,500 L</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 3.2% Today</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-rupee-sign" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Revenue</div>
              <div style="font-size: 1.8rem; font-weight: bold;">₹ 1,200,000</div>
              <div style="font-size: 0.85rem; color: #dc2626;">↓ 1.2% This Month</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-user-check" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Active Customers</div>
              <div style="font-size: 1.8rem; font-weight: bold;">1,850</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 4.1% Growth</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-truck" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Deliveries</div>
              <div style="font-size: 1.8rem; font-weight: bold;">980</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 2.4% This Week</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="banner">Expiry Tracking</div>
      <div class="alert-container">
        <div class="alert-item warning">
          <i class="fas fa-exclamation-triangle alert-icon"></i>
          <div>
            <strong>Batch #P10045 (Paneer)</strong> - Expires in 2 days (200 units)
          </div>
        </div>
        <div class="alert-item">
          <i class="fas fa-info-circle alert-icon"></i>
          <div>
            <strong>Batch #M10032 (Milk)</strong> - Expires in 5 days (500 units)
          </div>
        </div>
        <div class="alert-item success">
          <i class="fas fa-check-circle alert-icon"></i>
          <div>
            <strong>Batch #G10012 (Ghee)</strong> - Good for 45 more days
          </div>
        </div>
      </div>
      
      <div class="banner">Stock Alerts</div>
      <div class="row-grid">
        <div class="info-box warning hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Low Stock Items</h4>
          <p>Paneer (200g) - 120 units left</p>
          <p>Curd (500g) - 85 units left</p>
        </div>
        <div class="info-box hover-lift fade-up"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.06); transition: transform 0.3s ease;">
          <h4>Replenishment Needed</h4>
          <p>Milk Pouches - 2 days supply left</p>
          <p>Ghee Jars - 3 days supply left</p>
        </div>
      </div>
      <div class="banner">Inventory Details</div>
      <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
        <thead>
          <tr>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Product</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Stock</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Unit Cost</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Total Value</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Location</th>
            <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Milk Pouch (500 ml)</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">5,000</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 5.20</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 26,000</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Warehouse 1</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
              <span class="status-badge status-completed">In Stock</span>
            </td>
          </tr>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Bottle (1 L)</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">3,000</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 8.50</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 25,500</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Warehouse 2</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
              <span class="status-badge status-completed">In Stock</span>
            </td>
          </tr>
          <tr>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Paneer (200 g)</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">2,500</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 40.00</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 100,000</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Cold Storage</td>
            <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
              <span class="status-badge status-pending">Low Stock</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div class="section fade-in" id="logistics">
      <div class="banner">Distribution &amp; Logistics</div>
      <div class="cards-grid">
        <div class="card-grid">
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-tint" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Total Milk Collected</div>
              <div style="font-size: 1.8rem; font-weight: bold;">24,500 L</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 3.2% Today</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-rupee-sign" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Revenue</div>
              <div style="font-size: 1.8rem; font-weight: bold;">₹ 1,200,000</div>
              <div style="font-size: 0.85rem; color: #dc2626;">↓ 1.2% This Month</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-user-check" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Active Customers</div>
              <div style="font-size: 1.8rem; font-weight: bold;">1,850</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 4.1% Growth</div>
            </div>
          </div>
          <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
            <div
              style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
              <i class="fas fa-truck" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
            </div>
            <div>
              <div style="font-size: 0.9rem; color: #6b7280;">Deliveries</div>
              <div style="font-size: 1.8rem; font-weight: bold;">980</div>
              <div style="font-size: 0.85rem; color: #16a34a;">↑ 2.4% This Week</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="banner">Live Delivery Tracking</div>
      <div class="map-container">
        <div id="deliveryMap"></div>
      </div>
      
      <div class="banner">Vehicle Performance</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Average Delivery Times</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('deliveryTimesChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="deliveryTimesChart"></canvas>
        </div>
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Delay Reasons</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('delayReasonsChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="delayReasonsChart"></canvas>
        </div>
      </div>
      <div class="banner">Today's Deliveries</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Delivery ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Route</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Vehicle</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Stops</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">ETA</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">D4045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Route A</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Truck 101</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">8</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">Completed</span>
              </td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">10:30 AM</td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">D4044</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Route B</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Van 202</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">5</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-completed">In Progress</span>
              </td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">11:45 AM</td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">D4043</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Route C</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Truck 103</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">10</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">
                <span class="status-badge status-pending">Pending</span>
              </td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">01:15 PM</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="retail">
      <div class="banner">Retail &amp; Franchise</div>
      <div class="card-grid">
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-store card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Total Stores</div>
            <div style="font-size: 1.8rem; font-weight: bold;">50</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-money-bill-wave card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Avg Revenue/Store</div>
            <div style="font-size: 1.8rem; font-weight: bold;">₹ 10,000</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-plus-circle card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">New Stores (Month)</div>
            <div style="font-size: 1.8rem; font-weight: bold;">5</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
        <div class="card fade-up" style="display: flex; align-items: center; gap: 1rem;">
          <div
            style="background-color: rgba(66,133,244,0.1); padding: 0.75rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px;">
            <i class="fas fa-star card-icon" style="font-size: 1.25rem; color: #1d4ed8; margin: 0;"></i>
          </div>
          <div>
            <div style="font-size: 0.9rem; color: #6b7280;">Top Selling Product</div>
            <div style="font-size: 1.8rem; font-weight: bold;">Milk (500ml)</div>
            <div style="font-size: 0.85rem; color: #16a34a;"></div>
          </div>
        </div>
      </div>
      
      <div class="banner">Top Performing Stores</div>
      <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
        <div class="chart-box fade-up"
          style="min-width:300px; width:100%; flex:1;; margin-bottom: 2rem; min-width: 300px; width: 100%; flex: 1; margin-bottom:2rem; flex: 1 1 100%;">
          <div class="chart-header">
            <div class="chart-title">Revenue Trend (Top 5 Stores)</div>
            <div class="chart-actions">
              <button class="btn btn-export" onclick="exportChartToPDF('topStoresChart')">
                <i class="fas fa-file-pdf"></i> PDF
              </button>
            </div>
          </div>
          <canvas id="topStoresChart"></canvas>
        </div>
      </div>
      
      <div class="banner">Customer Feedback</div>
      <div class="feedback-container">
        <div class="feedback-card">
          <div class="feedback-header">
            <div class="feedback-store">Main Market Store</div>
            <div class="feedback-rating">4.8 ★</div>
          </div>
          <div class="feedback-comment">
            "Excellent quality milk, always fresh. Staff is very helpful."
          </div>
        </div>
        <div class="feedback-card">
          <div class="feedback-header">
            <div class="feedback-store">City Center Store</div>
            <div class="feedback-rating">4.5 ★</div>
          </div>
          <div class="feedback-comment">
            "Good variety of products. Could improve on paneer availability."
          </div>
        </div>
        <div class="feedback-card">
          <div class="feedback-header">
            <div class="feedback-store">Suburb Plaza Store</div>
            <div class="feedback-rating">4.2 ★</div>
          </div>
          <div class="feedback-comment">
            "Prices are reasonable. Need more frequent deliveries."
          </div>
        </div>
      </div>
      <div class="banner">Store Performance</div>
      <div class="table-wrapper">
        <table class="custom-table" style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Store ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Location</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Today's Sales</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Monthly Avg.</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Growth</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">S5045</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Main Market</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 15,245</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 12,500</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">+22%</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;"><span
                  class="status-badge status-completed">Open</span></td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">S5044</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">City Center</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 12,800</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 11,200</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">+14%</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;"><span
                  class="status-badge status-completed">Open</span></td>
            </tr>
            <tr>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">S5043</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">Suburb Plaza</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 8,450</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">₹ 9,800</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;">-14%</td>
              <td style="padding: 12px 16px; border-bottom: 1px solid #e5e7eb;"><span
                  class="status-badge status-pending">Closed</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="dashboard-section">
      
      <div class="card-grid">
        <div class="card fade-up">
          <div class="card-header">
            <span class="card-title">Total Customers</span>
            <div class="card-icon">
              <i class="fas fa-users"></i>
            </div>
          </div>
          <div class="card-value">248</div>
          <div class="card-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>12% from last month</span>
          </div>
        </div>
        <div class="card fade-up">
          <div class="card-header">
            <span class="card-title">Daily Collection</span>
            <div class="card-icon">
              <i class="fas fa-weight"></i>
            </div>
          </div>
          <div class="card-value">1,245 L</div>
          <div class="card-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>5% from yesterday</span>
          </div>
        </div>
        <div class="card fade-up">
          <div class="card-header">
            <span class="card-title">Pending Deliveries</span>
            <div class="card-icon">
              <i class="fas fa-truck"></i>
            </div>
          </div>
          <div class="card-value">18</div>
          <div class="card-change negative">
            <i class="fas fa-arrow-down"></i>
            <span>3 from yesterday</span>
          </div>
        </div>
        <div class="card fade-up">
          <div class="card-header">
            <span class="card-title">Monthly Revenue</span>
            <div class="card-icon">
              <i class="fas fa-dollar-sign"></i>
            </div>
          </div>
          <div class="card-value">$8,745</div>
          <div class="card-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>15% from last month</span>
          </div>
        </div>
      </div>
      
      <div class="card-gridss">
        <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
          <div class="chart-header">
            <h2 class="chart-title">Milk Collection Trend (Last 7 Days)</h2>
            <div class="chart-actions">
              <button class="chart-btn active" onclick="updateCollectionChart('7days')">
                7 Days
              </button>
              <button class="chart-btn" onclick="updateCollectionChart('30days')">
                30 Days
              </button>
              <button class="chart-btn" onclick="updateCollectionChart('90days')">
                90 Days
              </button>
            </div>
          </div>
          <canvas id="collectionChart"></canvas>
        </div>
        <div class="chart-container" style="display:flex; flex-wrap:wrap; gap:2rem;">
          <div class="chart-header">
            <h2 class="chart-title">Revenue Breakdown</h2>
          </div>
          <canvas id="revenueChart"></canvas>
        </div>
      </div>
      
      <div class="data-section">
        <div class="section-header">
          <h2 class="section-title">Recent Activity</h2>
          <div class="section-actions">
            <button class="btn btn-outline" onclick="exportActivityToPDF()">
              <i class="fas fa-file-pdf"></i>
              PDF
            </button>
            <button class="btn btn-outline" onclick="exportActivityToExcel()">
              <i class="fas fa-file-excel"></i>
              Excel
            </button>
            <button class="btn btn-primary" onclick="openModal('activity-modal')">
              <i class="fas fa-plus"></i>
              Add Activity
            </button>
          </div>
        </div>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Action</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">User</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Time</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Details</th>
            </tr>
          </thead>
          <tbody id="activity-table">
            
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="customers-section">
      <div class="tabs">
        <div class="tab active" onclick="showCustomerTab('all')">
          All Customers
        </div>
        <div class="tab" onclick="showCustomerTab('active')">Active</div>
        <div class="tab" onclick="showCustomerTab('inactive')">Inactive</div>
      </div>
      <div class="data-section">
        <div class="section-header">
          <h2 class="section-title">Customer Management</h2>
          <div class="section-actions">
            <button class="btn btn-outline" onclick="exportCustomersToPDF()">
              <i class="fas fa-file-pdf"></i>
              PDF
            </button>
            <button class="btn btn-outline" onclick="exportCustomersToExcel()">
              <i class="fas fa-file-excel"></i>
              Excel
            </button>
            <button class="btn btn-success" onclick="openCustomerModal()">
              <i class="fas fa-plus"></i>
              Add Customer
            </button>
          </div>
        </div>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Name</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Contact</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Address</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Delivery Schedule</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Actions</th>
            </tr>
          </thead>
          <tbody id="customers-table">
            
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="suppliers-section">
      <div class="data-section">
        <div class="section-header">
          <h2 class="section-title">Supplier Management</h2>
          <div class="section-actions">
            <button class="btn btn-outline" onclick="exportSuppliersToPDF()">
              <i class="fas fa-file-pdf"></i>
              PDF
            </button>
            <button class="btn btn-outline" onclick="exportSuppliersToExcel()">
              <i class="fas fa-file-excel"></i>
              Excel
            </button>
            <button class="btn btn-success" onclick="openSupplierModal()">
              <i class="fas fa-plus"></i>
              Add Supplier
            </button>
          </div>
        </div>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Name</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Contact</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Location</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Cows</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Avg. Yield</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Actions</th>
            </tr>
          </thead>
          <tbody id="suppliers-table">
            
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="deliveries-section">
      <div class="tabs">
        <div class="tab active" onclick="showDeliveryTab('today')">Today</div>
        <div class="tab" onclick="showDeliveryTab('upcoming')">Upcoming</div>
        <div class="tab" onclick="showDeliveryTab('completed')">
          Completed
        </div>
      </div>
      <div class="data-section">
        <div class="section-header">
          <h2 class="section-title">Delivery Management</h2>
          <div class="section-actions">
            <button class="btn btn-outline" onclick="exportDeliveriesToPDF()">
              <i class="fas fa-file-pdf"></i>
              PDF
            </button>
            <button class="btn btn-outline" onclick="exportDeliveriesToExcel()">
              <i class="fas fa-file-excel"></i>
              Excel
            </button>
            <button class="btn btn-success" onclick="openDeliveryModal()">
              <i class="fas fa-plus"></i>
              Schedule Delivery
            </button>
          </div>
        </div>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Customer</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Date</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Time</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Items</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Quantity</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Actions</th>
            </tr>
          </thead>
          <tbody id="deliveries-table">
            
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="payments-section">
      <div class="data-section">
        <div class="section-header">
          <h2 class="section-title">Payment Records</h2>
          <div class="section-actions">
            <button class="btn btn-outline" onclick="filterPayments('all')">
              All
            </button>
            <button class="btn btn-outline" onclick="filterPayments('pending')">
              Pending
            </button>
            <button class="btn btn-outline" onclick="filterPayments('completed')">
              Completed
            </button>
            <button class="btn btn-outline" onclick="exportPaymentsToPDF()">
              <i class="fas fa-file-pdf"></i>
              PDF
            </button>
            <button class="btn btn-outline" onclick="exportPaymentsToExcel()">
              <i class="fas fa-file-excel"></i>
              Excel
            </button>
            <button class="btn btn-success" onclick="openPaymentModal()">
              <i class="fas fa-plus"></i>
              Record Payment
            </button>
          </div>
        </div>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Payment ID</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Date</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Supplier</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Amount</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Method</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Status</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Actions</th>
            </tr>
          </thead>
          <tbody id="payments-table">
            
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="reports-section">
      <div class="chart-grid">
        <div class="chart-container"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
          <div class="chart-header">
            <h2 class="chart-title">Monthly Production</h2>
          </div>
          <canvas id="productionChart"></canvas>
        </div>
        <div class="chart-container"
          style="background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
          <div class="chart-header">
            <h2 class="chart-title">Customer Growth</h2>
          </div>
          <canvas id="growthChart"></canvas>
        </div>
      </div>
      <div class="data-section">
        <div class="section-header">
          <h2 class="section-title">Financial Summary</h2>
          <div class="section-actions">
            <button class="btn btn-outline" onclick="exportReportsToPDF()">
              <i class="fas fa-file-pdf"></i>
              PDF
            </button>
            <button class="btn btn-outline" onclick="exportReportsToExcel()">
              <i class="fas fa-file-excel"></i>
              Excel
            </button>
            <button class="btn btn-primary" onclick="generateReport()">
              <i class="fas fa-file-export"></i>
              Generate Report
            </button>
          </div>
        </div>
        <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
          <thead>
            <tr>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Period</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Revenue</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Expenses</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Profit</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">Milk Collected</th>
              <th style="background: #f3f4f6; padding: 12px 16px; text-align: left;">New Customers</th>
            </tr>
          </thead>
          <tbody id="reports-table">
            
          </tbody>
        </table>
      </div>
    </div>
    
    <div class="section fade-in" id="settings-section">
      <div class="settings-grid">
        <div class="setting-card">
          <h3 class="setting-title">Appearance</h3>
          <p class="setting-description">
            Customize the look and feel of your dashboard
          </p>
          <div class="form-group">
            <label for="theme-mode">Theme Mode</label>
            <div class="switch">
              <input id="theme-mode" onchange="toggleThemeMode()" type="checkbox" />
              <span class="slider"></span>
            </div>
            <span id="theme-mode-label" style="margin-left: 10px">Dark Mode</span>
          </div>
        </div>
        <div class="setting-card">
          <h3 class="setting-title">Notifications</h3>
          <p class="setting-description">
            Configure how you receive notifications
          </p>
          <div class="form-group">
            <label for="email-notifications">Email Notifications</label>
            <div class="switch">
              <input checked="" id="email-notifications" type="checkbox" />
              <span class="slider"></span>
            </div>
          </div>
          <div class="form-group">
            <label for="app-notifications">App Notifications</label>
            <div class="switch">
              <input checked="" id="app-notifications" type="checkbox" />
              <span class="slider"></span>
            </div>
          </div>
        </div>
        <div class="setting-card">
          <h3 class="setting-title">Data Management</h3>
          <p class="setting-description">Manage your data and backups</p>
          <div class="setting-actions">
            <button class="btn btn-outline" onclick="backupData()">
              <i class="fas fa-database"></i>
              Backup Data
            </button>
            <button class="btn btn-outline" onclick="restoreData()">
              <i class="fas fa-undo"></i>
              Restore Data
            </button>
          </div>
        </div>
        <div class="setting-card">
          <h3 class="setting-title">System Information</h3>
          <p class="setting-description">View system details and version</p>
          <div class="form-group">
            <label>Version</label>
            <p>DairyMaster Pro v2.1.0</p>
          </div>
          <div class="form-group">
            <label>Last Updated</label>
            <p>July 25, 2023</p>
          </div>
          <div class="setting-actions">
            <button class="btn btn-primary" onclick="checkForUpdates()">
              <i class="fas fa-sync-alt"></i>
              Check for Updates
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="section fade-in" id="profile">
      <div class="banner">Profile Settings</div>
      <form class="profile-form" onsubmit="saveProfile();return false;">
        <label>Name:</label>
        <input id="pName" placeholder="Rekha Iyer" type="text" />
        <label>Email:</label>
        <input id="pEmail" placeholder="Enter your email" type="email" />
        <label>Phone:</label>
        <input id="pPhone" pattern="[6-9][0-9]{9}" placeholder="Enter 10-digit Indian number" required=""
          title="Phone number must be 10 digits starting with 6,7,8 or 9" type="tel" />
        <label>Address:</label>
        <textarea id="pAddress" placeholder="Enter your address" rows="3"></textarea>
        <label>Language Preference:</label>
        <select id="pLanguage">
          <option value="en">English</option>
          <option value="hi">Hindi</option>
          <option value="te">Telugu</option>
          <option value="de">German</option>
        </select>
        <label>Work Mode:</label>
        <select id="pWorkMode">
          <option value="active">Active</option>
          <option value="away">Away</option>
          <option value="dnd">Do Not Disturb</option>
        </select>
        <button type="submit">Save Changes</button>
      </form>
    </div>
  </div>
  
  
  <div class="modal" id="customer-modal">
    <div class="modal-content"
      style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); max-width: 500px; margin: auto;">
      <span class="modal-close" onclick="closeModal('customer-modal')"
        style="position: absolute; top: 1rem; right: 1rem; font-size: 1.2rem; cursor: pointer;">×</span>
      <h2 class="modal-title" id="customer-modal-title">Add New Customer</h2>
      <form id="customer-form">
        <input id="customer-id" type="hidden" />
        <div class="form-group">
          <label for="customer-name">Full Name</label>
          <input class="form-control" id="customer-name" required="" type="text" />
        </div>
        <div class="form-group">
          <label for="customer-phone">Phone</label>
          <input class="form-control" id="customer-phone" required="" type="tel" />
        </div>
        <div class="form-group">
          <label for="customer-email">Email</label>
          <input class="form-control" id="customer-email" type="email" />
        </div>
        <div class="form-group">
          <label for="customer-address">Address</label>
          <textarea class="form-control" id="customer-address" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="customer-payment">Payment Method</label>
          <select class="form-control" id="customer-payment">
            <option value="Cash">Cash</option>
            <option value="Credit Card">Credit Card</option>
            <option value="Bank Transfer">Bank Transfer</option>
          </select>
        </div>
        <div class="form-group">
          <label for="customer-schedule">Delivery Schedule</label>
          <select class="form-control" id="customer-schedule">
            <option value="Daily">Daily</option>
            <option value="MWF">Monday, Wednesday, Friday</option>
            <option value="TTS">Tuesday, Thursday, Saturday</option>
            <option value="Weekly">Weekly</option>
          </select>
        </div>
        <div class="form-group">
          <label for="customer-status">Status</label>
          <select class="form-control" id="customer-status">
            <option value="Active">Active</option>
            <option value="Inactive">Inactive</option>
          </select>
        </div>
        <div class="form-actions">
          <button class="btn btn-outline" onclick="closeModal('customer-modal')" type="button">
            Cancel
          </button>
          <button class="btn btn-primary" type="submit">Save Customer</button>
        </div>
      </form>
    </div>
  </div>
  
  <div class="modal" id="delivery-modal">
    <div class="modal-content"
      style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); max-width: 500px; margin: auto;">
      <span class="modal-close" onclick="closeModal('delivery-modal')"
        style="position: absolute; top: 1rem; right: 1rem; font-size: 1.2rem; cursor: pointer;">×</span>
      <h2 class="modal-title" id="delivery-modal-title">Schedule Delivery</h2>
      <form id="delivery-form">
        <input id="delivery-id" type="hidden" />
        <div class="form-group">
          <label for="delivery-customer">Customer</label>
          <select class="form-control" id="delivery-customer" required="">
            
          </select>
        </div>
        <div class="form-group">
          <label for="delivery-date">Date</label>
          <input class="form-control" id="delivery-date" required="" type="date" />
        </div>
        <div class="form-group">
          <label for="delivery-time">Time</label>
          <select class="form-control" id="delivery-time" required="">
            <option value="Morning">Morning</option>
            <option value="Evening">Evening</option>
          </select>
        </div>
        <div class="form-group">
          <label for="delivery-items">Items</label>
          <input class="form-control" id="delivery-items" required="" type="text" />
        </div>
        <div class="form-group">
          <label for="delivery-quantity">Quantity (Liters)</label>
          <input class="form-control" id="delivery-quantity" min="1" required="" type="number" />
        </div>
        <div class="form-group">
          <label for="delivery-notes">Special Instructions</label>
          <textarea class="form-control" id="delivery-notes" rows="3"></textarea>
        </div>
        <div class="form-actions">
          <button class="btn btn-outline" onclick="closeModal('delivery-modal')" type="button">
            Cancel
          </button>
          <button class="btn btn-primary" type="submit">
            Schedule Delivery
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <div class="modal" id="supplier-modal">
    <div class="modal-content"
      style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); max-width: 500px; margin: auto;">
      <span class="modal-close" onclick="closeModal('supplier-modal')"
        style="position: absolute; top: 1rem; right: 1rem; font-size: 1.2rem; cursor: pointer;">×</span>
      <h2 class="modal-title" id="supplier-modal-title">Add New Supplier</h2>
      <form id="supplier-form">
        <input id="supplier-id" type="hidden" />
        <div class="form-group">
          <label for="supplier-name">Name</label>
          <input class="form-control" id="supplier-name" required="" type="text" />
        </div>
        <div class="form-group">
          <label for="supplier-contact">Contact</label>
          <input class="form-control" id="supplier-contact" required="" type="text" />
        </div>
        <div class="form-group">
          <label for="supplier-location">Location</label>
          <input class="form-control" id="supplier-location" required="" type="text" />
        </div>
        <div class="form-group">
          <label for="supplier-cows">Number of Cows</label>
          <input class="form-control" id="supplier-cows" min="1" required="" type="number" />
        </div>
        <div class="form-group">
          <label for="supplier-yield">Average Yield (Liters/Day)</label>
          <input class="form-control" id="supplier-yield" min="1" required="" step="0.1" type="number" />
        </div>
        <div class="form-group">
          <label for="supplier-status">Status</label>
          <select class="form-control" id="supplier-status" required="">
            <option value="Active">Active</option>
            <option value="Inactive">Inactive</option>
            <option value="New">New</option>
          </select>
        </div>
        <div class="form-actions">
          <button class="btn btn-outline" onclick="closeModal('supplier-modal')" type="button">
            Cancel
          </button>
          <button class="btn btn-primary" type="submit">Save Supplier</button>
        </div>
      </form>
    </div>
  </div>
  
  <div class="modal" id="payment-modal">
    <div class="modal-content"
      style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); max-width: 500px; margin: auto;">
      <span class="modal-close" onclick="closeModal('payment-modal')"
        style="position: absolute; top: 1rem; right: 1rem; font-size: 1.2rem; cursor: pointer;">×</span>
      <h2 class="modal-title" id="payment-modal-title">Record Payment</h2>
      <form id="payment-form">
        <input id="payment-id" type="hidden" />
        <div class="form-group">
          <label for="payment-supplier">Supplier</label>
          <select class="form-control" id="payment-supplier" required="">
            
          </select>
        </div>
        <div class="form-group">
          <label for="payment-date">Date</label>
          <input class="form-control" id="payment-date" required="" type="date" />
        </div>
        <div class="form-group">
          <label for="payment-amount">Amount</label>
          <input class="form-control" id="payment-amount" min="0" required="" step="0.01" type="number" />
        </div>
        <div class="form-group">
          <label for="payment-method">Method</label>
          <select class="form-control" id="payment-method" required="">
            <option value="Cash">Cash</option>
            <option value="Bank Transfer">Bank Transfer</option>
            <option value="Check">Check</option>
          </select>
        </div>
        <div class="form-group">
          <label for="payment-status">Status</label>
          <select class="form-control" id="payment-status" required="">
            <option value="Pending">Pending</option>
            <option value="Completed">Completed</option>
          </select>
        </div>
        <div class="form-group">
          <label for="payment-notes">Notes</label>
          <textarea class="form-control" id="payment-notes" rows="3"></textarea>
        </div>
        <div class="form-actions">
          <button class="btn btn-outline" onclick="closeModal('payment-modal')" type="button">
            Cancel
          </button>
          <button class="btn btn-primary" type="submit">
            Record Payment
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <div class="modal" id="activity-modal">
    <div class="modal-content"
      style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); max-width: 500px; margin: auto;">
      <span class="modal-close" style="display: none" onclick="closeModal()"
        style="position: absolute; top: 1rem; right: 1rem; font-size: 1.2rem; cursor: pointer;">×</span>
      <h2 class="modal-title">Add Activity</h2>
      <form id="activity-form">
        <div class="form-group">
          <label for="activity-type">Type</label>
          <select class="form-control" id="activity-type" required="">
            <option value="Note">Note</option>
            <option value="Reminder">Reminder</option>
            <option value="Issue">Issue</option>
            <option value="Alert">Alert</option>
          </select>
        </div>
        <div class="form-group">
          <label for="activity-content">Content</label>
          <textarea class="form-control" id="activity-content" required="" rows="4"></textarea>
        </div>
        <div class="form-actions">
          <button class="btn btn-outline" onclick="closeModal()" type="button">
            Cancel
          </button>
          <button class="btn btn-primary" type="submit">Add Activity</button>
        </div>
      </form>
    </div>
  </div>
  
  <script>
    function applyTheme(mode) {
      const html = document.documentElement;
      html.classList.toggle('dark-mode', mode === 'dark');
      localStorage.setItem('theme', mode);
      const icon = document.querySelector('#theme-toggle i');
      if (icon) {
        icon.className = mode === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
      }
      const label = document.getElementById("theme-mode-label");
      if (label) {
        label.textContent = mode === "dark" ? "Dark Mode" : "Light Mode";
        label.style.color = mode === "dark" ? "var(--dark)" : "var(--text)";
      }
      const toggleCheckbox = document.getElementById("theme-mode");
      if (toggleCheckbox) {
        toggleCheckbox.checked = (mode === 'dark');
      }
    }

    function toggleTheme() {
      const isDark = document.documentElement.classList.contains("dark-mode");
      applyTheme(isDark ? "light" : "dark");
    }

    document.addEventListener("DOMContentLoaded", () => {
      const savedTheme = localStorage.getItem("theme") || "light";
      applyTheme(savedTheme);

      const toggleBtn = document.getElementById("theme-toggle");
      if (toggleBtn) {
        toggleBtn.addEventListener("click", toggleTheme);
      }

      const themeCheckbox = document.getElementById("theme-mode");
      if (themeCheckbox) {
        themeCheckbox.addEventListener("change", () => {
          applyTheme(themeCheckbox.checked ? "dark" : "light");
        });
      }
    });



    // Auto-format phone input (prevents non-numbers and limits to 10 digits)
    document.getElementById("pPhone").addEventListener("input", function (e) {
      this.value = this.value.replace(/\D/g, '').substring(0, 10);
    });

    // Chart references
    let milkBarChart, investmentPieChart, milkCollectChart, fatSnfChart, trainingChart, qualityChart;
    let capacityChart, testHistoryChart, failureReasonsChart, deliveryTimesChart, delayReasonsChart, topStoresChart;
    let farmerMap, deliveryMap;

    const chartData = {
      milkBarChart: {
        labels: ["April", "May", "June", "July", "August", "September", "October", "November", "Sep", "Oct", "Nov", "Dec"],
        datasets: [{
          label: "Milk Purchased (L)",
          data: [8900, 9400, 10100, 11200, 12500, 13100, 14500, 12800, 11900, 10400, 9900, 10900]
        }]
      },
      investmentPieChart: {
        labels: ["Milk Packaging", "Curd Packaging", "Ghee Packaging", "Paneer Packaging", "Other"],
        datasets: [{
          label: "Investment Amount (₹)",
          data: [100000, 80000, 170000, 50000, 14900]
        }]
      },
      milkCollectChart: {
        labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
        datasets: [{
          label: "Collected (L)",
          data: [1800, 2000, 2200, 2100, 2500, 2300, 2400]
        }]
      },
      fatSnfChart: {
        labels: ["Farmer 1", "Farmer 2", "Farmer 3", "Farmer 4", "Farmer 5", "Farmer 6"],
        datasets: [
          {
            label: "Fat %",
            data: [4.2, 3.8, 4.5, 3.9, 4.1, 3.7],
            borderColor: "#3b82f6",
            backgroundColor: "rgba(59, 130, 246, 0.5)"
          },
          {
            label: "SNF %",
            data: [8.5, 8.2, 8.7, 8.3, 8.6, 8.1],
            borderColor: "#10b981",
            backgroundColor: "rgba(16, 185, 129, 0.5)"
          }
        ]
      },
      trainingChart: {
        labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
        datasets: [{
          label: "Farmers Trained",
          data: [120, 150, 180, 200, 220, 250],
          backgroundColor: "rgba(59, 130, 246, 0.5)"
        }]
      },
      qualityChart: {
        labels: ["Village A", "Village B", "Village C", "Village D", "Village E"],
        datasets: [{
          label: "Quality Compliance %",
          data: [92, 88, 95, 90, 85],
          backgroundColor: [
            "rgba(16, 185, 129, 0.5)",
            "rgba(16, 185, 129, 0.5)",
            "rgba(16, 185, 129, 0.5)",
            "rgba(16, 185, 129, 0.5)",
            "rgba(239, 68, 68, 0.5)"
          ]
        }]
      },
      capacityChart: {
        labels: ["Center A", "Center B", "Center C", "Center D", "Center E"],
        datasets: [{
          label: "Capacity Utilization %",
          data: [85, 92, 78, 65, 88],
          backgroundColor: "rgba(59, 130, 246, 0.5)"
        }]
      },
      testHistoryChart: {
        labels: ["Week 1", "Week 2", "Week 3", "Week 4", "Week 5"],
        datasets: [
          {
            label: "Passed",
            data: [95, 97, 93, 96],
            backgroundColor: "rgba(16, 185, 129, 0.5)"
          },
          {
            label: "Failed",
            data: [5, 3, 7, 4],
            backgroundColor: "rgba(239, 68, 68, 0.5)"
          }
        ]
      },
      failureReasonsChart: {
        labels: ["High Acidity", "Low Fat", "Low SNF", "Contamination"],
        datasets: [{
          label: "Failure Reasons",
          data: [65, 20, 10, 5],
          backgroundColor: [
            "rgba(239, 68, 68, 0.5)",
            "rgba(234, 179, 8, 0.5)",
            "rgba(59, 130, 246, 0.5)",
            "rgba(107, 114, 128, 0.5)"
          ]
        }]
      },
      deliveryTimesChart: {
        labels: ["Route A", "Route B", "Route C", "Route D"],
        datasets: [{
          label: "Average Delivery Time (hours)",
          data: [2.1, 2.5, 1.8, 2.3],
          backgroundColor: "rgba(59, 130, 246, 0.5)"
        }]
      },
      delayReasonsChart: {
        labels: ["Traffic", "Vehicle Issues", "Loading Delays", "Other"],
        datasets: [{
          label: "Delay Reasons",
          data: [60, 20, 15, 5],
          backgroundColor: [
            "rgba(239, 68, 68, 0.5)",
            "rgba(234, 179, 8, 0.5)",
            "rgba(59, 130, 246, 0.5)",
            "rgba(107, 114, 128, 0.5)"
          ]
        }]
      },
      topStoresChart: {
        labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
        datasets: [
          {
            label: "Main Market Store",
            data: [12000, 12500, 13000, 13500, 14000, 14500],
            borderColor: "#3b82f6"
          },
          {
            label: "City Center Store",
            data: [11000, 11500, 12000, 12500, 13000, 13500],
            borderColor: "#10b981"
          },
          {
            label: "Suburb Plaza Store",
            data: [9000, 9500, 10000, 10500, 11000, 11500],
            borderColor: "#f59e0b"
          }
        ]
      }
    };

    // Initialize maps
    function initFarmerMap() {
      farmerMap = L.map('farmerMap').setView([20.5937, 78.9629], 5);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(farmerMap);

      // Mock farmer locations (in a real app, these would come from your data)
      const farmerLocations = [
        { lat: 19.0760, lng: 72.8777, count: 120, name: "Mumbai" },
        { lat: 28.6139, lng: 77.2090, count: 85, name: "Delhi" },
        { lat: 12.9716, lng: 77.5946, count: 65, name: "Bangalore" },
        { lat: 17.3850, lng: 78.4867, count: 210, name: "Hyderabad" },
        { lat: 13.0827, lng: 80.2707, count: 75, name: "Chennai" },
        { lat: 26.9124, lng: 75.7873, count: 45, name: "Jaipur" }
      ];

      // Add markers for each location
      farmerLocations.forEach(location => {
        let color;
        if (location.count > 200) color = '#ef4444';
        else if (location.count > 100) color = '#f59e0b';
        else if (location.count > 50) color = '#10b981';
        else color = '#3b82f6';

        L.circleMarker([location.lat, location.lng], {
          radius: Math.sqrt(location.count) * 0.8,
          fillColor: color,
          color: '#000',
          weight: 1,
          opacity: 1,
          fillOpacity: 0.8
        }).addTo(farmerMap)
          .bindPopup(`<b>${location.name}</b><br>Farmers: ${location.count}`);
      });
    }

    function initDeliveryMap() {
      deliveryMap = L.map('deliveryMap').setView([20.5937, 78.9629], 5);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(deliveryMap);

      // Mock delivery routes (in a real app, these would come from your data)
      const routes = [
        {
          name: "Route A",
          coordinates: [[19.0760, 72.8777], [19.2183, 72.9781], [19.1383, 72.9111]],
          status: "completed",
          vehicle: "Truck 101"
        },
        {
          name: "Route B",
          coordinates: [[19.0760, 72.8777], [19.0176, 72.8561], [18.9750, 72.8258]],
          status: "in-progress",
          vehicle: "Van 202"
        },
        {
          name: "Route C",
          coordinates: [[19.0760, 72.8777], [19.0760, 73.8777], [19.0760, 74.8777]],
          status: "pending",
          vehicle: "Truck 103"
        }
      ];

      // Add routes to the map
      routes.forEach(route => {
        let color;
        if (route.status === "completed") color = '#10b981';
        else if (route.status === "in-progress") color = '#f59e0b';
        else color = '#ef4444';

        L.polyline(route.coordinates, { color: color, weight: 3 }).addTo(deliveryMap)
          .bindPopup(`<b>${route.name}</b><br>Vehicle: ${route.vehicle}<br>Status: ${route.status.replace('-', ' ')}`);
      });

      // Add markers for start/end points
      routes.forEach(route => {
        L.marker(route.coordinates[0]).addTo(deliveryMap)
          .bindPopup(`<b>Start: ${route.name}</b>`);

        L.marker(route.coordinates[route.coordinates.length - 1]).addTo(deliveryMap)
          .bindPopup(`<b>End: ${route.name}</b>`);
      });
    }

    // —— PDF Export for Charts using jsPDF ——
    function exportChartToPDF(chartId) {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('landscape');

      // Get chart instance based on ID
      let chart;
      switch (chartId) {
        case 'milkBarChart': chart = milkBarChart; break;
        case 'investmentPieChart': chart = investmentPieChart; break;
        case 'milkCollectChart': chart = milkCollectChart; break;
        case 'fatSnfChart': chart = fatSnfChart; break;
        case 'trainingChart': chart = trainingChart; break;
        case 'qualityChart': chart = qualityChart; break;
        case 'capacityChart': chart = capacityChart; break;
        case 'testHistoryChart': chart = testHistoryChart; break;
        case 'failureReasonsChart': chart = failureReasonsChart; break;
        case 'deliveryTimesChart': chart = deliveryTimesChart; break;
        case 'delayReasonsChart': chart = delayReasonsChart; break;
        case 'topStoresChart': chart = topStoresChart; break;
      }

      // 1. Add title
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(16);
      const title = document.querySelector(`#${chartId}`).parentNode.querySelector('.chart-title').textContent;
      doc.text(title, 140, 20, { align: 'center' });

      // 2. Add chart image (top half)
      const imgData = document.getElementById(chartId).toDataURL('image/png');
      doc.addImage(imgData, 'PNG', 40, 30, 200, 100);

      // 3. Add data table (bottom half)
      doc.setFontSize(12);
      doc.text('Detailed Data:', 20, 140);

      // Prepare table data
      const headers = ["Period"].concat(chart.data.datasets.map(ds => ds.label));
      const rows = chart.data.labels.map((label, i) =>
        [label].concat(chart.data.datasets.map(ds => ds.data[i]))
      );

      // Generate table
      doc.autoTable({
        startY: 150,
        head: [headers],
        body: rows,
        styles: { fontSize: 10, cellPadding: 3 },
        columnStyles: {
          0: { fontStyle: 'bold', cellWidth: 30 }
        }
      });

      // 4. Add footer
      doc.setFontSize(10);
      doc.text(`Exported on ${new Date().toLocaleDateString()}`, 140, 280, { align: 'center' });

      // Save PDF
      doc.save(`${title.replace(/ /g, '_')}_Export.pdf`);
    }

    // —— Excel Export for Charts ——
    function exportChartToExcel(chartId) {
      const data = chartData[chartId];
      const chartTitle = document.querySelector(`#${chartId}`).parentNode.querySelector('.chart-title').textContent;

      let worksheet;
      if (chartId === 'investmentPieChart' || chartId === 'failureReasonsChart' || chartId === 'delayReasonsChart') {
        // For pie charts, create two columns: Category and Value
        const rows = data.labels.map((label, i) => ({
          Category: label,
          [data.datasets[0].label]: data.datasets[0].data[i]
        }));
        worksheet = XLSX.utils.json_to_sheet(rows);
      } else {
        // For bar/line charts, create columns for each dataset
        const rows = data.labels.map((label, i) => {
          const row = { Period: label };
          data.datasets.forEach(ds => {
            row[ds.label] = ds.data[i];
          });
          return row;
        });
        worksheet = XLSX.utils.json_to_sheet(rows);
      }

      // Create a new workbook
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Chart Data");

      // Generate the Excel file
      XLSX.writeFile(workbook, `${chartTitle.replace(/[^a-z0-9]/gi, '_')}_${new Date().getTime()}.xlsx`);
    }

    // —— Charts Initialization ——
    window.addEventListener("DOMContentLoaded", () => {
      loadProfile();
      initFarmerMap();
      initDeliveryMap();

      // Milk Procurement Chart (Bar)
      milkBarChart = new Chart(document.getElementById("milkBarChart").getContext("2d"), {
        type: "bar",
        data: chartData.milkBarChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw.toLocaleString()} L`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) { return value.toLocaleString() + " L"; }
              }
            }
          }
        }
      });

      // Investment Pie Chart
      investmentPieChart = new Chart(document.getElementById("investmentPieChart").getContext("2d"), {
        type: "pie",
        data: chartData.investmentPieChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: "bottom",
              labels: { padding: 20, usePointStyle: true, pointStyle: "circle" }
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  const label = context.label || "";
                  const value = context.raw || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = Math.round((value / total) * 100);
                  return `${label}: ₹${value.toLocaleString()} (${percentage}%)`;
                }
              }
            }
          }
        }
      });

      // Milk Collection Chart (Line)
      milkCollectChart = new Chart(document.getElementById("milkCollectChart").getContext("2d"), {
        type: "line",
        data: chartData.milkCollectChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw.toLocaleString()} L`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) { return value.toLocaleString() + " L"; }
              }
            }
          }
        }
      });

      // Fat/SNF Analysis Chart
      fatSnfChart = new Chart(document.getElementById("fatSnfChart").getContext("2d"), {
        type: "bar",
        data: chartData.fatSnfChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw}%`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 10,
              ticks: {
                callback: function (value) { return value + "%"; }
              }
            }
          }
        }
      });

      // Training Participation Chart
      trainingChart = new Chart(document.getElementById("trainingChart").getContext("2d"), {
        type: "bar",
        data: chartData.trainingChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw}`;
                }
              }
            }
          }
        }
      });

      // Quality Compliance Chart
      qualityChart = new Chart(document.getElementById("qualityChart").getContext("2d"), {
        type: "bar",
        data: chartData.qualityChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw}%`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                callback: function (value) { return value + "%"; }
              }
            }
          }
        }
      });

      // Capacity Utilization Chart
      capacityChart = new Chart(document.getElementById("capacityChart").getContext("2d"), {
        type: "bar",
        data: chartData.capacityChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw}%`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                callback: function (value) { return value + "%"; }
              }
            }
          }
        }
      });

      // Test History Chart
      testHistoryChart = new Chart(document.getElementById("testHistoryChart").getContext("2d"), {
        type: "bar",
        data: chartData.testHistoryChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw}%`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                callback: function (value) { return value + "%"; }
              }
            }
          }
        }
      });

      // Failure Reasons Chart
      failureReasonsChart = new Chart(document.getElementById("failureReasonsChart").getContext("2d"), {
        type: "pie",
        data: chartData.failureReasonsChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: "bottom",
              labels: { padding: 20, usePointStyle: true, pointStyle: "circle" }
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  const label = context.label || "";
                  const value = context.raw || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = Math.round((value / total) * 100);
                  return `${label}: ${value} (${percentage}%)`;
                }
              }
            }
          }
        }
      });

      // Delivery Times Chart
      deliveryTimesChart = new Chart(document.getElementById("deliveryTimesChart").getContext("2d"), {
        type: "bar",
        data: chartData.deliveryTimesChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ${context.raw} hours`;
                }
              }
            }
          }
        }
      });

      // Delay Reasons Chart
      delayReasonsChart = new Chart(document.getElementById("delayReasonsChart").getContext("2d"), {
        type: "pie",
        data: chartData.delayReasonsChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: "bottom",
              labels: { padding: 20, usePointStyle: true, pointStyle: "circle" }
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  const label = context.label || "";
                  const value = context.raw || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = Math.round((value / total) * 100);
                  return `${label}: ${value} (${percentage}%)`;
                }
              }
            }
          }
        }
      });

      // Top Stores Chart
      topStoresChart = new Chart(document.getElementById("topStoresChart").getContext("2d"), {
        type: "line",
        data: chartData.topStoresChart,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            tooltip: {
              callbacks: {
                label: function (context) {
                  return `${context.dataset.label}: ₹${context.raw.toLocaleString()}`;
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) { return '₹' + value.toLocaleString(); }
              }
            }
          }
        }
      });
    });

    // —— Sidebar toggle ——
    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("collapsed");
      document.querySelector(".main").classList.toggle("collapsed");
    }

    // —— Navigation ——
    function activateNav(el, sectionId) {
      document.querySelectorAll(".sidebar li").forEach((li) => li.classList.remove("active"));
      el.classList.add("active");
      document.querySelectorAll(".section").forEach((sec) => sec.classList.remove("active"));
      document.getElementById(sectionId).classList.add("active");
      window.scrollTo(0, 0);

      // Reinitialize maps when their sections are shown
      if (sectionId === 'farmer-mgmt' && farmerMap) {
        setTimeout(() => {
          farmerMap.invalidateSize();
        }, 300);
      }
      if (sectionId === 'logistics' && deliveryMap) {
        setTimeout(() => {
          deliveryMap.invalidateSize();
        }, 300);
      }
    }

    function showSection(sectionId) {
      const navItem = document.querySelector(`.sidebar li[onclick*="${sectionId}"]`);
      if (navItem) activateNav(navItem, sectionId);
    }

    // —— Language & Work Mode ——
    function setLanguage(lang) {
      const languages = { en: "English", hi: "Hindi", te: "Telugu", de: "German" };
      document.querySelector(".dropdown-btn span").className =
        (lang === "en" ? "green" : lang === "hi" ? "red" : "gray");
      document.querySelector(".dropdown-btn").innerHTML =
        `<span class=" ${lang === "en" ? "green" : lang === "hi" ? "red" : "gray"}"></span> ${languages[lang]}`;
      localStorage.setItem("language", lang);
    }

    function setWorkMode(mode) {
      const modes = { active: "Active", away: "Away", dnd: "Do Not Disturb" };
      document.querySelectorAll(".dropdown-btn")[1].innerHTML =
        `<span class="dot ${mode === "active" ? "green" : mode === "away" ? "gray" : "red"}"></span> ${modes[mode]}`;
      localStorage.setItem("workMode", mode);
    }

    // —— Profile Save/Load ——
    function saveProfile() {
      const phoneInput = document.getElementById("pPhone");
      const phoneValue = phoneInput.value.replace(/\D/g, ''); // Remove non-digits

      // Validate phone number
      if (!/^[6-9]\d{9}$/.test(phoneValue)) {
        alert("❌ Invalid Indian number! Must be 10 digits starting with 6,7,8 or 9");
        phoneInput.focus();
        return false;
      }

      const profile = {
        name: document.getElementById("pName").value,
        email: document.getElementById("pEmail").value,
        phone: "+91 " + phoneValue, // Format as +91 XXXXXXXXXX
        address: document.getElementById("pAddress").value,
        language: document.getElementById("pLanguage").value,
        workMode: document.getElementById("pWorkMode").value,
      };

      localStorage.setItem("profile", JSON.stringify(profile));
      document.querySelector(".profile-name").textContent = profile.name;
      setLanguage(profile.language);
      setWorkMode(profile.workMode);
      alert("✅ Profile saved successfully!");
      return false; // Prevent form submission
    }

    function loadProfile() {
      const profile = JSON.parse(localStorage.getItem("profile")) || {};
      if (profile.name) {
        document.getElementById("pName").value = profile.name;
        document.getElementById("pEmail").value = profile.email || "";
        document.getElementById("pPhone").value = profile.phone || "";
        document.getElementById("pAddress").value = profile.address || "";
        document.getElementById("pLanguage").value = profile.language || "en";
        document.getElementById("pWorkMode").value = profile.workMode || "active";
        document.querySelector(".profile-name").textContent = profile.name;
        setLanguage(profile.language || "en");
        setWorkMode(profile.workMode || "active");
      }
    }

    // Orders functionality
    const orders = [
      [
        { id: '#10245', name: 'Shiva Kumar', products: 'Milk (2), Curd (1), Paneer (3)', total: '₹2280.50', date: 'Today, 10:45 AM' },
        { id: '#10244', name: 'Aravind Bandi', products: 'Paneer (2), Ghee (1)', total: '₹1800.75', date: 'Today, 9:30 AM' },
        { id: '#10243', name: 'Santhosh Kumar', products: 'Milk (2), Ghee (1)', total: '₹1200.25', date: 'Yesterday, 4:15 PM' }
      ],
      [
        { id: '#10242', name: 'Kiran Kumar', products: 'Curd (3), Milk (1)', total: '₹980.00', date: 'Yesterday, 11:00 AM' },
        { id: '#10241', name: 'Priya Reddy', products: 'Paneer (2)', total: '₹900.00', date: 'Yesterday, 10:00 AM' },
        { id: '#10240', name: 'Anil Kumar', products: 'Ghee (2)', total: '₹1200.00', date: '2 days ago, 5:00 PM' }
      ],
      [
        { id: '#10239', name: 'Meena Devi', products: 'Milk (5)', total: '₹1500.00', date: '2 days ago, 2:00 PM' },
        { id: '#10238', name: 'Ravi Teja', products: 'Curd (2), Paneer (1)', total: '₹1100.00', date: '3 days ago, 3:30 PM' },
        { id: '#10237', name: 'Lakshmi Narayana', products: 'Milk (1), Ghee (1)', total: '₹950.00', date: '3 days ago, 1:00 PM' }
      ]
    ];

    let currentPage = 1;

    function changePage(pageNum) {
      currentPage = pageNum;
      const tbody = document.getElementById('ordersBody');
      tbody.innerHTML = '';
      orders[pageNum - 1].forEach((order, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${order.id}</td>
            <td>${order.name}</td>
            <td>${order.products}</td>
            <td>${order.total}</td>
            <td>${order.date}</td>
            <td><span class="status">Completed</span></td>
            <td><button class="details-btn" onclick="showDetails('${order.id}', '${order.name}', '${order.products}', '${order.total}', '${order.date}')">Details</button></td>
          `;
        tbody.appendChild(row);
      });

      document.querySelectorAll('.page-btn').forEach(btn => btn.classList.remove('active'));
      if (document.querySelectorAll('.page-btn')[pageNum - 1]) {
        document.querySelectorAll('.page-btn')[pageNum - 1].classList.add('active');
      }
    }

    function showDetails(id, name, products, total, date) {
      const info = `
          <strong>Order ID:</strong> ${id}<br>
          <strong>Customer:</strong> ${name}<br>
          <strong>Products:</strong> ${products}<br>
          <strong>Total:</strong> ${total}<br>
          <strong>Date:</strong> ${date}
        `;
      document.getElementById('modalOrderInfo').innerHTML = info;
      document.getElementById('orderModal').style.display = 'flex';
    }

    function formatDate(dateString) {
      const options = { year: "numeric", month: "short", day: "numeric" };
      return new Date(dateString).toLocaleDateString("en-US", options);
    }


    function loadDeliveries(filter = "today") {
      const table = document.getElementById("deliveries-table");
      table.innerHTML = "";

      let deliveries = appData.deliveries;
      const today = new Date().toISOString().split("T")[0];

      if (filter === "today") {
        deliveries = deliveries.filter((d) => d.date === today);
      } else if (filter === "upcoming") {
        deliveries = deliveries.filter((d) => d.date > today);
      } else if (filter === "completed") {
        deliveries = deliveries.filter(
          (d) => d.date < today || d.status === "Completed"
        );
      }

      deliveries.forEach((delivery) => {
        const customer = appData.customers.find(
          (c) => c.id === delivery.customerId
        );
        const row = document.createElement("tr");
        row.innerHTML = `
                    <td>${customer ? customer.name : "Unknown"}</td>
                    <td>${formatDate(delivery.date)}</td>
                    <td>${delivery.time}</td>
                    <td>${delivery.items}</td>
                    <td>${delivery.quantity}L</td>
                    <td><span class="status ${delivery.status === "Completed"
            ? "status-completed"
            : delivery.status === "Pending"
              ? "status-pending"
              : "status-active"
          }">${delivery.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="openDeliveryModal(${delivery.id
          })">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="deleteDelivery(${delivery.id
          })">
                            <i class="fas fa-trash"></i>
                        </button>
                        ${delivery.status !== "Completed"
            ? `
                        <button class="action-btn" onclick="completeDelivery(${delivery.id})">
                            <i class="fas fa-check"></i>
                        </button>`
            : ""
          }
                    </td>
                `;
        table.appendChild(row);
      });
    }


    function exportPaymentsToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.text("Payment Records", 10, 10);
      let y = 20;

      appData.payments.forEach((payment) => {
        const supplier = appData.suppliers.find(
          (s) => s.id === payment.supplierId
        );
        doc.text(`Payment ID: ${payment.id}`, 10, y);
        doc.text(`Date: ${formatDate(payment.date)}`, 10, y + 5);
        doc.text(
          `Supplier: ${supplier ? supplier.name : "Unknown"}`,
          10,
          y + 10
        );
        doc.text(`Amount: $${payment.amount.toFixed(2)}`, 10, y + 15);
        doc.text(`Method: ${payment.method}`, 10, y + 20);
        doc.text(`Status: ${payment.status}`, 10, y + 25);
        doc.text("--------------------------------", 10, y + 30);
        y += 35;
      });

      doc.save("payments.pdf");
    }

    function exportDeliveriesToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.text("Delivery List", 10, 10);
      let y = 20;

      appData.deliveries.forEach((delivery) => {
        const customer = appData.customers.find(
          (c) => c.id === delivery.customerId
        );
        doc.text(`Customer: ${customer ? customer.name : "Unknown"}`, 10, y);
        doc.text(`Date: ${formatDate(delivery.date)}`, 10, y + 5);
        doc.text(`Time: ${delivery.time}`, 10, y + 10);
        doc.text(`Items: ${delivery.items}`, 10, y + 15);
        doc.text(`Quantity: ${delivery.quantity}L`, 10, y + 20);
        doc.text(`Status: ${delivery.status}`, 10, y + 25);
        doc.text("--------------------------------", 10, y + 30);
        y += 35;
      });

      doc.save("deliveries.pdf");
    }

    function loadPayments(filter = "all") {
      const table = document.getElementById("payments-table");
      table.innerHTML = "";

      let payments = appData.payments;
      if (filter === "pending") {
        payments = payments.filter((p) => p.status === "Pending");
      } else if (filter === "completed") {
        payments = payments.filter((p) => p.status === "Completed");
      }

      payments.forEach((payment) => {
        const supplier = appData.suppliers.find(
          (s) => s.id === payment.supplierId
        );
        const row = document.createElement("tr");
        row.innerHTML = `
                    <td>${payment.id}</td>
                    <td>${formatDate(payment.date)}</td>
                    <td>${supplier ? supplier.name : "Unknown"}</td>
                    <td>$${payment.amount.toFixed(2)}</td>
                    <td>${payment.method}</td>
                    <td><span class="status ${payment.status === "Completed"
            ? "status-completed"
            : "status-pending"
          }">${payment.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="openPaymentModal('${payment.id
          }')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="deletePayment('${payment.id
          }')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
        table.appendChild(row);
      });
    }


    function exportDeliveriesToExcel() {
      const data = appData.deliveries.map((delivery) => {
        const customer = appData.customers.find(
          (c) => c.id === delivery.customerId
        );
        return {
          Customer: customer ? customer.name : "Unknown",
          Date: formatDate(delivery.date),
          Time: delivery.time,
          Items: delivery.items,
          "Quantity (L)": delivery.quantity,
          Status: delivery.status,
          Notes: delivery.notes,
        };
      });

      const worksheet = XLSX.utils.json_to_sheet(data);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Deliveries");
      XLSX.writeFile(workbook, "deliveries.xlsx");
    }

    function exportPaymentsToExcel() {
      const data = appData.payments.map((payment) => {
        const supplier = appData.suppliers.find(
          (s) => s.id === payment.supplierId
        );
        return {
          "Payment ID": payment.id,
          Date: formatDate(payment.date),
          Supplier: supplier ? supplier.name : "Unknown",
          Amount: payment.amount,
          Method: payment.method,
          Status: payment.status,
          Notes: payment.notes,
        };
      });

      const worksheet = XLSX.utils.json_to_sheet(data);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Payments");
      XLSX.writeFile(workbook, "payments.xlsx");
    }


    function closeModal() {
      document.getElementById('orderModal').style.display = 'none';
    }

    // Load first page initially
    changePage(1);


    // Application Data
    const appData = {
      customers: [
        {
          id: 1,
          name: "John Doe",
          phone: "+1 (555) 123-4567",
          email: "john.doe@example.com",
          address: "123 Main St, New York, NY",
          payment: "Credit Card",
          status: "Active",
          deliverySchedule: "Daily",
        },
        {
          id: 2,
          name: "Jane Smith",
          phone: "+1 (555) 987-6543",
          email: "jane.smith@example.com",
          address: "456 Oak Ave, Boston, MA",
          payment: "Bank Transfer",
          status: "Active",
          deliverySchedule: "MWF",
        },
        {
          id: 3,
          name: "Robert Johnson",
          phone: "+1 (555) 456-7890",
          email: "robert.j@example.com",
          address: "789 Pine Rd, Chicago, IL",
          payment: "Cash",
          status: "Inactive",
          deliverySchedule: "Weekly",
        },
      ],
      suppliers: [
        {
          id: 1,
          name: "Rajesh Patel",
          contact: "9876543210",
          location: "Village A",
          cows: 5,
          yield: 24.5,
          status: "Active",
        },
        {
          id: 2,
          name: "Meena Sharma",
          contact: "8765432109",
          location: "Village B",
          cows: 8,
          yield: 38.2,
          status: "Active",
        },
        {
          id: 3,
          name: "Vijay Kumar",
          contact: "7654321098",
          location: "Village C",
          cows: 12,
          yield: 52.7,
          status: "New",
        },
      ],
      deliveries: [
        {
          id: 1,
          customerId: 1,
          date: new Date().toISOString().split("T")[0],
          time: "Morning",
          items: "Standard Milk",
          quantity: 2,
          notes: "Leave at doorstep",
          status: "Pending",
        },
        {
          id: 2,
          customerId: 2,
          date: new Date().toISOString().split("T")[0],
          time: "Evening",
          items: "Low-fat Milk",
          quantity: 1,
          notes: "Ring bell twice",
          status: "Pending",
        },
        {
          id: 3,
          customerId: 1,
          date: new Date(Date.now() + 86400000).toISOString().split("T")[0],
          time: "Morning",
          items: "Standard Milk + Curd",
          quantity: 3,
          notes: "",
          status: "Scheduled",
        },
        {
          id: 4,
          customerId: 2,
          date: new Date(Date.now() - 86400000).toISOString().split("T")[0],
          time: "Evening",
          items: "Skimmed Milk",
          quantity: 2,
          notes: "Delivered successfully",
          status: "Completed",
        },
      ],
      payments: [
        {
          id: "PY-2023-0719",
          supplierId: 1,
          date: "2023-07-19",
          amount: 5420,
          method: "Bank Transfer",
          status: "Completed",
          notes: "Regular payment",
        },
        {
          id: "PY-2023-0718",
          supplierId: 2,
          date: "2023-07-18",
          amount: 8320,
          method: "Cash",
          status: "Completed",
          notes: "Bonus included",
        },
        {
          id: "PY-2023-0720",
          supplierId: 3,
          date: new Date().toISOString().split("T")[0],
          amount: 3120,
          method: "Bank Transfer",
          status: "Pending",
          notes: "New supplier payment",
        },
      ],
      activities: [
        {
          id: 1,
          type: "Note",
          content: "Customer requested early delivery tomorrow",
          user: "Admin",
          time: "Today, 10:30 AM",
        },
        {
          id: 2,
          type: "Reminder",
          content: "Follow up with supplier about quality issue",
          user: "Admin",
          time: "Today, 09:15 AM",
        },
        {
          id: 3,
          type: "Issue",
          content: "Reported milk consistency problem from SP-1002",
          user: "Quality Control",
          time: "Yesterday, 3:45 PM",
        },
        {
          id: 4,
          type: "Alert",
          content: "Low inventory alert for plastic bottles",
          user: "Inventory",
          time: "Yesterday, 11:20 AM",
        },
      ],
      reports: [
        {
          period: "July 2023",
          revenue: 8745,
          expenses: 4520,
          profit: 4225,
          milkCollected: 1245,
          newCustomers: 12,
        },
        {
          period: "June 2023",
          revenue: 7980,
          expenses: 4120,
          profit: 3860,
          milkCollected: 1180,
          newCustomers: 8,
        },
        {
          period: "May 2023",
          revenue: 7450,
          expenses: 3980,
          profit: 3470,
          milkCollected: 1050,
          newCustomers: 5,
        },
      ],
      settings: {
        darkMode: false,
        emailNotifications: true,
        appNotifications: true,
      },
    };

    // Chart instances
    let collectionChart, revenueChart, productionChart, growthChart;

    // Initialize the application
    document.addEventListener("DOMContentLoaded", function () {
      // Load all data
      loadCustomers();
      loadSuppliers();
      loadDeliveries();
      loadPayments();
      loadActivities();
      loadReports();
      loadSettings();

      // Initialize charts
      initCharts();

      // Setup form submissions
      document
        .getElementById("customer-form")
        .addEventListener("submit", saveCustomer);
      document
        .getElementById("supplier-form")
        .addEventListener("submit", saveSupplier);
      document
        .getElementById("delivery-form")
        .addEventListener("submit", saveDelivery);
      document
        .getElementById("payment-form")
        .addEventListener("submit", savePayment);
      document
        .getElementById("activity-form")
        .addEventListener("submit", saveActivity);

      // Set default dates in forms
      const today = new Date();
      document.getElementById("delivery-date").valueAsDate = today;
      document.getElementById("payment-date").valueAsDate = today;

      // Theme toggle
      document
        .getElementById("theme-toggle")
        .addEventListener("click", toggleTheme);
    });

    // Navigation functions
    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll(".content-section").forEach((section) => {
        section.style.display = "none";
      });

      // Show selected section
      const section = document.getElementById(`${sectionId}-section`);
      section.style.display = "block";
      section.classList.add("fade-in");

      // Update page title
      document.getElementById("page-title").textContent =
        sectionId.charAt(0).toUpperCase() + sectionId.slice(1);

      // Refresh specific sections if needed
      if (sectionId === "reports") {
        updateCharts();
      }
    }

    function showCustomerTab(tab) {
      document.querySelectorAll("#customers-section .tab").forEach((t) => {
        t.classList.remove("active");
      });
      event.currentTarget.classList.add("active");
      loadCustomers(tab);
    }

    function showDeliveryTab(tab) {
      document.querySelectorAll("#deliveries-section .tab").forEach((t) => {
        t.classList.remove("active");
      });
      event.currentTarget.classList.add("active");
      loadDeliveries(tab);
    }

    // Modal functions
    function openModal(modalId) {
      document.getElementById(modalId).style.display = "flex";

      // Initialize forms if needed
      if (modalId === "delivery-modal") {
        initDeliveryForm();
      } else if (modalId === "payment-modal") {
        initPaymentForm();
      }
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = "none";
      document.getElementById(modalId.replace("-modal", "-form")).reset();
    }

    function openCustomerModal(customerId = null) {
      if (customerId) {
        const customer = appData.customers.find((c) => c.id === customerId);
        if (customer) {
          document.getElementById("customer-id").value = customer.id;
          document.getElementById("customer-name").value = customer.name;
          document.getElementById("customer-phone").value = customer.phone;
          document.getElementById("customer-email").value = customer.email;
          document.getElementById("customer-address").value =
            customer.address;
          document.getElementById("customer-payment").value =
            customer.payment;
          document.getElementById("customer-schedule").value =
            customer.deliverySchedule;
          document.getElementById("customer-status").value = customer.status;

          document.getElementById("customer-modal-title").textContent =
            "Edit Customer";
        }
      } else {
        document.getElementById("customer-id").value = "";
        document.getElementById("customer-modal-title").textContent =
          "Add New Customer";
      }
      openModal("customer-modal");
    }

    function openDeliveryModal(deliveryId = null) {
      if (deliveryId) {
        const delivery = appData.deliveries.find((d) => d.id === deliveryId);
        if (delivery) {
          document.getElementById("delivery-id").value = delivery.id;
          document.getElementById("delivery-customer").value =
            delivery.customerId;
          document.getElementById("delivery-date").value = delivery.date;
          document.getElementById("delivery-time").value = delivery.time;
          document.getElementById("delivery-items").value = delivery.items;
          document.getElementById("delivery-quantity").value =
            delivery.quantity;
          document.getElementById("delivery-notes").value = delivery.notes;

          document.getElementById("delivery-modal-title").textContent =
            "Edit Delivery";
        }
      } else {
        document.getElementById("delivery-id").value = "";
        document.getElementById("delivery-modal-title").textContent =
          "Schedule Delivery";
      }
      openModal("delivery-modal");
    }

    function openSupplierModal(supplierId = null) {
      if (supplierId) {
        const supplier = appData.suppliers.find((s) => s.id === supplierId);
        if (supplier) {
          document.getElementById("supplier-id").value = supplier.id;
          document.getElementById("supplier-name").value = supplier.name;
          document.getElementById("supplier-contact").value =
            supplier.contact;
          document.getElementById("supplier-location").value =
            supplier.location;
          document.getElementById("supplier-cows").value = supplier.cows;
          document.getElementById("supplier-yield").value = supplier.yield;
          document.getElementById("supplier-status").value = supplier.status;

          document.getElementById("supplier-modal-title").textContent =
            "Edit Supplier";
        }
      } else {
        document.getElementById("supplier-id").value = "";
        document.getElementById("supplier-modal-title").textContent =
          "Add New Supplier";
      }
      openModal("supplier-modal");
    }

    function openPaymentModal(paymentId = null) {
      if (paymentId) {
        const payment = appData.payments.find((p) => p.id === paymentId);
        if (payment) {
          document.getElementById("payment-id").value = payment.id;
          document.getElementById("payment-supplier").value =
            payment.supplierId;
          document.getElementById("payment-date").value = payment.date;
          document.getElementById("payment-amount").value = payment.amount;
          document.getElementById("payment-method").value = payment.method;
          document.getElementById("payment-status").value = payment.status;
          document.getElementById("payment-notes").value = payment.notes;

          document.getElementById("payment-modal-title").textContent =
            "Edit Payment";
        }
      } else {
        // Generate new payment ID
        const today = new Date();
        const paymentId = `PY-${today.getFullYear()}-${(today.getMonth() + 1)
          .toString()
          .padStart(2, "0")}${today.getDate().toString().padStart(2, "0")}`;
        document.getElementById("payment-id").value = paymentId;
        document.getElementById("payment-modal-title").textContent =
          "Record Payment";
      }
      openModal("payment-modal");
    }

    // Form initialization
    function initDeliveryForm() {
      const select = document.getElementById("delivery-customer");
      select.innerHTML = '<option value="">Select Customer</option>';

      appData.customers
        .filter((c) => c.status === "Active")
        .forEach((customer) => {
          const option = document.createElement("option");
          option.value = customer.id;
          option.textContent = customer.name;
          select.appendChild(option);
        });

      // Set default date to today
      document.getElementById("delivery-date").valueAsDate = new Date();
    }

    function initPaymentForm() {
      const select = document.getElementById("payment-supplier");
      select.innerHTML = '<option value="">Select Supplier</option>';

      appData.suppliers.forEach((supplier) => {
        const option = document.createElement("option");
        option.value = supplier.id;
        option.textContent = supplier.name;
        select.appendChild(option);
      });

      // Set default date to today
      document.getElementById("payment-date").valueAsDate = new Date();
    }

    // Data loading functions
    function loadCustomers(filter = "all") {
      const table = document.getElementById("customers-table");
      table.innerHTML = "";

      let customers = appData.customers;
      if (filter === "active") {
        customers = customers.filter((c) => c.status === "Active");
      } else if (filter === "inactive") {
        customers = customers.filter((c) => c.status === "Inactive");
      }

      customers.forEach((customer) => {
        const row = document.createElement("tr");
        row.innerHTML = `
                    <td>${customer.name}</td>
                    <td>${customer.phone}</td>
                    <td>${customer.address}</td>
                    <td>${customer.deliverySchedule}</td>
                    <td><span class="status ${customer.status === "Active"
            ? "status-active"
            : "status-inactive"
          }">${customer.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="openCustomerModal(${customer.id
          })">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="deleteCustomer(${customer.id
          })">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
        table.appendChild(row);
      });
    }

    function loadSuppliers() {
      const table = document.getElementById("suppliers-table");
      table.innerHTML = "";

      appData.suppliers.forEach((supplier) => {
        const row = document.createElement("tr");
        row.innerHTML = `
                    <td>${supplier.name}</td>
                    <td>${supplier.contact}</td>
                    <td>${supplier.location}</td>
                    <td>${supplier.cows}</td>
                    <td>${supplier.yield} L</td>
                    <td><span class="status ${supplier.status === "Active"
            ? "status-active"
            : supplier.status === "New"
              ? "status-pending"
              : "status-inactive"
          }">${supplier.status}</span></td>
                    <td>
                        <button class="action-btn" onclick="openSupplierModal(${supplier.id
          })">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="deleteSupplier(${supplier.id
          })">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
        table.appendChild(row);
      });
    }


    function loadActivities() {
      const table = document.getElementById("activity-table");
      table.innerHTML = "";

      appData.activities.forEach((activity) => {
        const row = document.createElement("tr");
        row.innerHTML = `
                    <td><span class="status ${activity.type === "Note"
            ? "status-active"
            : activity.type === "Reminder"
              ? "status-pending"
              : "status-inactive"
          }">${activity.type}</span></td>
                    <td>${activity.user}</td>
                    <td>${activity.time}</td>
                    <td>${activity.content}</td>
                `;
        table.appendChild(row);
      });
    }

    function loadReports() {
      const table = document.getElementById("reports-table");
      table.innerHTML = "";

      appData.reports.forEach((report) => {
        const row = document.createElement("tr");
        row.innerHTML = `
                    <td>${report.period}</td>
                    <td>$${report.revenue.toFixed(2)}</td>
                    <td>$${report.expenses.toFixed(2)}</td>
                    <td>$${report.profit.toFixed(2)}</td>
                    <td>${report.milkCollected} L</td>
                    <td>${report.newCustomers}</td>
                `;
        table.appendChild(row);
      });
    }

    function loadSettings() {
      document.getElementById("theme-mode").checked =
        appData.settings.darkMode;
      document.getElementById("email-notifications").checked =
        appData.settings.emailNotifications;
      document.getElementById("app-notifications").checked =
        appData.settings.appNotifications;
      updateThemeModeLabel();
    }

    // Chart initialization
    function initCharts() {
      // Milk Collection Chart
      const collectionCtx = document
        .getElementById("collectionChart")
        .getContext("2d");
      collectionChart = new Chart(collectionCtx, {
        type: "line",
        data: {
          labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
          datasets: [
            {
              label: "Milk Collection (Liters)",
              data: [1200, 1150, 1250, 1300, 1245, 1100, 1050],
              borderColor: "var(--primary)",
              backgroundColor: "rgba(66, 133, 244, 0.1)",
              borderWidth: 2,
              tension: 0.3,
              fill: true,
            },
          ],
        },
        options: getChartOptions("Milk Collection Trend (Last 7 Days)"),
      });

      // Revenue Chart
      const revenueCtx = document
        .getElementById("revenueChart")
        .getContext("2d");
      revenueChart = new Chart(revenueCtx, {
        type: "doughnut",
        data: {
          labels: ["Retail", "Wholesale", "Online", "Subscriptions"],
          datasets: [
            {
              data: [65, 20, 10, 5],
              backgroundColor: [
                "#4285F4", // Blue
                "#34A853", // Green
                "#EA4335", // Red
                "#FBBC05", // Yellow
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: "right",
              labels: {
                color: "var(--text)",
              },
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  const label = context.label || "";
                  const value = context.raw || 0;
                  const total = context.dataset.data.reduce(
                    (a, b) => a + b,
                    0
                  );
                  const percentage = Math.round((value / total) * 100);
                  return `${label}: $${value} (${percentage}%)`;
                },
              },
            },
          },
        },
      });

      // Production Chart
      const productionCtx = document
        .getElementById("productionChart")
        .getContext("2d");
      productionChart = new Chart(productionCtx, {
        type: "bar",
        data: {
          labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
          datasets: [
            {
              label: "Milk Production (Liters)",
              data: [32000, 34000, 36000, 38000, 37000, 39000, 40000],
              backgroundColor: "rgba(66, 133, 244, 0.7)",
              borderColor: "var(--primary)",
              borderWidth: 1,
            },
          ],
        },
        options: getChartOptions("Monthly Milk Production)"),
      });

      // Growth Chart
      const growthCtx = document
        .getElementById("growthChart")
        .getContext("2d");
      growthChart = new Chart(growthCtx, {
        type: "line",
        data: {
          labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
          datasets: [
            {
              label: "Total Customers",
              data: [180, 190, 200, 210, 220, 235, 248],
              borderColor: "var(--secondary)",
              backgroundColor: "rgba(52, 168, 83, 0.1)",
              borderWidth: 2,
              tension: 0.3,
              fill: true,
            },
          ],
        },
        options: getChartOptions("Customer Growth)"),
      });
    }

    function getChartOptions(title) {
      return {
        responsive: true,
        plugins: {
          legend: {
            position: "top",
            labels: {
              color: "var(--text)",
            },
          },
          title: {
            display: true,
            text: title,
            color: "var(--text)",
          },
          tooltip: {
            mode: "index",
            intersect: false,
          },
        },
        scales: {
          x: {
            grid: {
              color: "var(--border)",
            },
            ticks: {
              color: "var(--text-light)",
            },
          },
          y: {
            grid: {
              color: "var(--border)",
            },
            ticks: {
              color: "var(--text-light)",
            },
            beginAtZero: false,
          },
        },
      };
    }

    function updateCharts() {
      // Update data for all charts
      collectionChart.data.datasets[0].data = [
        1200, 1150, 1250, 1300, 1245, 1100, 1050,
      ];
      collectionChart.update();

      revenueChart.data.datasets[0].data = [65, 20, 10, 5];
      revenueChart.update();

      productionChart.data.datasets[0].data = [
        32000, 34000, 36000, 38000, 37000, 39000, 40000,
      ];
      productionChart.update();

      growthChart.data.datasets[0].data = [180, 190, 200, 210, 220, 235, 248];
      growthChart.update();
    }

    function updateCollectionChart(range) {
      let labels, data;

      if (range === "7days") {
        labels = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
        data = [1200, 1150, 1250, 1300, 1245, 1100, 1050];
        collectionChart.options.plugins.title.text =
          "Milk Collection Trend (Last 7 Days)";
      } else if (range === "30days") {
        labels = ["Week 1", "Week 2", "Week 3", "Week 4", "Week 5"];
        data = [8500, 8700, 8900, 8800];
        collectionChart.options.plugins.title.text =
          "Milk Collection Trend (Last 30 Days)";
      } else if (range === "90days") {
        labels = ["Month 1", "Month 2", "Month 3"];
        data = [35000, 37000, 36000];
        collectionChart.options.plugins.title.text =
          "Milk Collection Trend (Last 90 Days)";
      }

      collectionChart.data.labels = labels;
      collectionChart.data.datasets[0].data = data;
      collectionChart.update();

      // Update active button
      document
        .querySelectorAll("#collectionChart + .chart-actions .chart-btn")
        .forEach((btn) => {
          btn.classList.remove("active");
        });
      event.currentTarget.classList.add("active");
    }

    // CRUD operations
    function saveCustomer(e) {
      e.preventDefault();

      const id = document.getElementById("customer-id").value;
      const customer = {
        name: document.getElementById("customer-name").value,
        phone: document.getElementById("customer-phone").value,
        email: document.getElementById("customer-email").value,
        address: document.getElementById("customer-address").value,
        payment: document.getElementById("customer-payment").value,
        deliverySchedule: document.getElementById("customer-schedule").value,
        status: document.getElementById("customer-status").value,
      };

      if (id) {
        // Update existing customer
        const index = appData.customers.findIndex((c) => c.id == id);
        appData.customers[index] = {
          ...appData.customers[index],
          ...customer,
        };

        // Add activity
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Updated customer: ${customer.name}`,
          user: "Admin",
          time: getCurrentTime(),
        });
      } else {
        // Add new customer
        customer.id = getNextId(appData.customers);
        appData.customers.push(customer);

        // Add activity
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Added new customer: ${customer.name}`,
          user: "Admin",
          time: getCurrentTime(),
        });
      }

      closeModal("customer-modal");
      loadCustomers();
      loadActivities();
    }

    function saveSupplier(e) {
      e.preventDefault();

      const id = document.getElementById("supplier-id").value;
      const supplier = {
        name: document.getElementById("supplier-name").value,
        contact: document.getElementById("supplier-contact").value,
        location: document.getElementById("supplier-location").value,
        cows: parseInt(document.getElementById("supplier-cows").value),
        yield: parseFloat(document.getElementById("supplier-yield").value),
        status: document.getElementById("supplier-status").value,
      };

      if (id) {
        // Update existing supplier
        const index = appData.suppliers.findIndex((s) => s.id == id);
        appData.suppliers[index] = {
          ...appData.suppliers[index],
          ...supplier,
        };

        // Add activity
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Updated supplier: ${supplier.name}`,
          user: "Admin",
          time: getCurrentTime(),
        });
      } else {
        // Add new supplier
        supplier.id = getNextId(appData.suppliers);
        appData.suppliers.push(supplier);

        // Add activity
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Added new supplier: ${supplier.name}`,
          user: "Admin",
          time: getCurrentTime(),
        });
      }

      closeModal("supplier-modal");
      loadSuppliers();
      loadActivities();
    }

    function saveDelivery(e) {
      e.preventDefault();

      const id = document.getElementById("delivery-id").value;
      const delivery = {
        customerId: parseInt(
          document.getElementById("delivery-customer").value
        ),
        date: document.getElementById("delivery-date").value,
        time: document.getElementById("delivery-time").value,
        items: document.getElementById("delivery-items").value,
        quantity: parseInt(
          document.getElementById("delivery-quantity").value
        ),
        notes: document.getElementById("delivery-notes").value,
        status: id
          ? appData.deliveries.find((d) => d.id == id).status
          : "Pending",
      };

      if (id) {
        // Update existing delivery
        const index = appData.deliveries.findIndex((d) => d.id == id);
        appData.deliveries[index] = {
          ...appData.deliveries[index],
          ...delivery,
        };

        // Add activity
        const customer = appData.customers.find(
          (c) => c.id == delivery.customerId
        );
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Updated delivery for ${customer ? customer.name : "customer"
            }`,
          user: "Admin",
          time: getCurrentTime(),
        });
      } else {
        // Add new delivery
        delivery.id = getNextId(appData.deliveries);
        appData.deliveries.push(delivery);

        // Add activity
        const customer = appData.customers.find(
          (c) => c.id == delivery.customerId
        );
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Scheduled delivery for ${customer ? customer.name : "customer"
            }: ${delivery.quantity}L ${delivery.items}`,
          user: "Admin",
          time: getCurrentTime(),
        });
      }

      closeModal("delivery-modal");
      loadDeliveries();
      loadActivities();
    }

    function savePayment(e) {
      e.preventDefault();

      const id = document.getElementById("payment-id").value;
      const payment = {
        supplierId: parseInt(
          document.getElementById("payment-supplier").value
        ),
        date: document.getElementById("payment-date").value,
        amount: parseFloat(document.getElementById("payment-amount").value),
        method: document.getElementById("payment-method").value,
        status: document.getElementById("payment-status").value,
        notes: document.getElementById("payment-notes").value,
      };

      if (id.startsWith("PY-")) {
        // Update existing payment
        const index = appData.payments.findIndex((p) => p.id === id);
        if (index >= 0) {
          appData.payments[index] = {
            ...appData.payments[index],
            ...payment,
          };

          // Add activity
          const supplier = appData.suppliers.find(
            (s) => s.id == payment.supplierId
          );
          appData.activities.unshift({
            id: getNextId(appData.activities),
            type: "Note",
            content: `Updated payment record for ${supplier ? supplier.name : "supplier"
              }`,
            user: "Admin",
            time: getCurrentTime(),
          });
        }
      } else {
        // Add new payment
        const today = new Date();
        payment.id = `PY-${today.getFullYear()}-${(today.getMonth() + 1)
          .toString()
          .padStart(2, "0")}${today.getDate().toString().padStart(2, "0")}`;
        appData.payments.push(payment);

        // Add activity
        const supplier = appData.suppliers.find(
          (s) => s.id == payment.supplierId
        );
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Recorded payment to ${supplier ? supplier.name : "supplier"
            }: $${payment.amount.toFixed(2)}`,
          user: "Admin",
          time: getCurrentTime(),
        });
      }

      closeModal("payment-modal");
      loadPayments();
      loadActivities();
    }

    function saveActivity(e) {
      e.preventDefault();

      const activity = {
        id: getNextId(appData.activities),
        type: document.getElementById("activity-type").value,
        content: document.getElementById("activity-content").value,
        user: "Admin",
        time: getCurrentTime(),
      };

      appData.activities.unshift(activity);
      closeModal("activity-modal");
      loadActivities();
    }

    // Delete operations
    function deleteCustomer(id) {
      if (confirm("Are you sure you want to delete this customer?")) {
        const customer = appData.customers.find((c) => c.id === id);
        if (customer) {
          // Add activity
          appData.activities.unshift({
            id: getNextId(appData.activities),
            type: "Alert",
            content: `Deleted customer: ${customer.name}`,
            user: "Admin",
            time: getCurrentTime(),
          });

          // Remove customer
          appData.customers = appData.customers.filter((c) => c.id !== id);
          loadCustomers();
          loadActivities();
        }
      }
    }

    function deleteSupplier(id) {
      if (confirm("Are you sure you want to delete this supplier?")) {
        const supplier = appData.suppliers.find((s) => s.id === id);
        if (supplier) {
          // Add activity
          appData.activities.unshift({
            id: getNextId(appData.activities),
            type: "Alert",
            content: `Deleted supplier: ${supplier.name}`,
            user: "Admin",
            time: getCurrentTime(),
          });

          // Remove supplier
          appData.suppliers = appData.suppliers.filter((s) => s.id !== id);
          loadSuppliers();
          loadActivities();
        }
      }
    }

    function deleteDelivery(id) {
      if (confirm("Are you sure you want to delete this delivery?")) {
        const delivery = appData.deliveries.find((d) => d.id === id);
        if (delivery) {
          // Add activity
          const customer = appData.customers.find(
            (c) => c.id === delivery.customerId
          );
          appData.activities.unshift({
            id: getNextId(appData.activities),
            type: "Alert",
            content: `Deleted delivery for ${customer ? customer.name : "customer"
              }`,
            user: "Admin",
            time: getCurrentTime(),
          });

          // Remove delivery
          appData.deliveries = appData.deliveries.filter((d) => d.id !== id);
          loadDeliveries();
          loadActivities();
        }
      }
    }

    function deletePayment(id) {
      if (confirm("Are you sure you want to delete this payment record?")) {
        const payment = appData.payments.find((p) => p.id === id);
        if (payment) {
          // Add activity
          const supplier = appData.suppliers.find(
            (s) => s.id === payment.supplierId
          );
          appData.activities.unshift({
            id: getNextId(appData.activities),
            type: "Alert",
            content: `Deleted payment record for ${supplier ? supplier.name : "supplier"
              }`,
            user: "Admin",
            time: getCurrentTime(),
          });

          // Remove payment
          appData.payments = appData.payments.filter((p) => p.id !== id);
          loadPayments();
          loadActivities();
        }
      }
    }

    // Other operations
    function completeDelivery(id) {
      const delivery = appData.deliveries.find((d) => d.id === id);
      if (delivery) {
        delivery.status = "Completed";

        // Add activity
        const customer = appData.customers.find(
          (c) => c.id === delivery.customerId
        );
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: `Completed delivery for ${customer ? customer.name : "customer"
            }`,
          user: "Admin",
          time: getCurrentTime(),
        });

        loadDeliveries();
        loadActivities();
      }
    }

    function filterPayments(filter) {
      loadPayments(filter);
    }

    // Export functions
    function exportCustomersToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.text("Customer List", 10, 10);
      let y = 20;

      appData.customers.forEach((customer) => {
        doc.text(`Name: ${customer.name}`, 10, y);
        doc.text(`Phone: ${customer.phone}`, 10, y + 5);
        doc.text(`Email: ${customer.email}`, 10, y + 10);
        doc.text(`Address: ${customer.address}`, 10, y + 15);
        doc.text(`Status: ${customer.status}`, 10, y + 20);
        doc.text("--------------------------------", 10, y + 25);
        y += 30;
      });

      doc.save("customers.pdf");
    }

    function exportSuppliersToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.text("Supplier List", 10, 10);
      let y = 20;

      appData.suppliers.forEach((supplier) => {
        doc.text(`Name: ${supplier.name}`, 10, y);
        doc.text(`Contact: ${supplier.contact}`, 10, y + 5);
        doc.text(`Location: ${supplier.location}`, 10, y + 10);
        doc.text(`Cows: ${supplier.cows}`, 10, y + 15);
        doc.text(`Avg. Yield: ${supplier.yield} L/day`, 10, y + 20);
        doc.text(`Status: ${supplier.status}`, 10, y + 25);
        doc.text("--------------------------------", 10, y + 30);
        y += 35;
      });

      doc.save("suppliers.pdf");
    }


    function exportActivityToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.text("Activity Log", 10, 10);
      let y = 20;

      appData.activities.forEach((activity) => {
        doc.text(`Type: ${activity.type}`, 10, y);
        doc.text(`User: ${activity.user}`, 10, y + 5);
        doc.text(`Time: ${activity.time}`, 10, y + 10);
        doc.text(`Details: ${activity.content}`, 10, y + 15);
        doc.text("--------------------------------", 10, y + 20);
        y += 25;
      });

      doc.save("activity_log.pdf");
    }

    function exportReportsToPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.text("Financial Reports", 10, 10);
      let y = 20;

      appData.reports.forEach((report) => {
        doc.text(`Period: ${report.period}`, 10, y);
        doc.text(`Revenue: $${report.revenue.toFixed(2)}`, 10, y + 5);
        doc.text(`Expenses: $${report.expenses.toFixed(2)}`, 10, y + 10);
        doc.text(`Profit: $${report.profit.toFixed(2)}`, 10, y + 15);
        doc.text(`Milk Collected: ${report.milkCollected} L`, 10, y + 20);
        doc.text(`New Customers: ${report.newCustomers}`, 10, y + 25);
        doc.text("--------------------------------", 10, y + 30);
        y += 35;
      });

      doc.save("financial_reports.pdf");
    }

    function exportCustomersToExcel() {
      const worksheet = XLSX.utils.json_to_sheet(appData.customers);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Customers");
      XLSX.writeFile(workbook, "customers.xlsx");
    }

    function exportSuppliersToExcel() {
      const worksheet = XLSX.utils.json_to_sheet(appData.suppliers);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Suppliers");
      XLSX.writeFile(workbook, "suppliers.xlsx");
    }

    function exportActivityToExcel() {
      const worksheet = XLSX.utils.json_to_sheet(appData.activities);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Activity Log");
      XLSX.writeFile(workbook, "activity_log.xlsx");
    }

    function exportReportsToExcel() {
      const worksheet = XLSX.utils.json_to_sheet(appData.reports);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Financial Reports");
      XLSX.writeFile(workbook, "financial_reports.xlsx");
    }

    // Settings functions
    function toggleTheme() {
      document.body.classList.toggle("dark-mode");
      appData.settings.darkMode =
        document.body.classList.contains("dark-mode");
      updateThemeModeLabel();
      updateCharts();
    }

    function toggleThemeMode() {
      document.body.classList.toggle(
        "dark-mode",
        document.getElementById("theme-mode").checked
      );
      appData.settings.darkMode =
        document.getElementById("theme-mode").checked;
      updateThemeModeLabel();
      updateCharts();
    }

    function updateThemeModeLabel() {
      const label = document.getElementById("theme-mode-label");
      label.textContent = appData.settings.darkMode
        ? "Dark Mode"
        : "Light Mode";
      label.style.color = appData.settings.darkMode
        ? "var(--dark)"
        : "var(--text)";
    }

    function backupData() {
      const dataStr = JSON.stringify(appData, null, 2);
      const dataUri =
        "data:application/json;charset=utf-8," + encodeURIComponent(dataStr);

      const exportName =
        "dairymaster_backup_" +
        new Date().toISOString().split("T")[0] +
        ".json";

      const linkElement = document.createElement("a");
      linkElement.setAttribute("href", dataUri);
      linkElement.setAttribute("download", exportName);
      linkElement.click();

      // Add activity
      appData.activities.unshift({
        id: getNextId(appData.activities),
        type: "Note",
        content: "System data backup created",
        user: "System",
        time: getCurrentTime(),
      });
      loadActivities();
    }

    function restoreData() {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = ".json";

      input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();

        reader.onload = (event) => {
          try {
            const data = JSON.parse(event.target.result);
            Object.assign(appData, data);

            // Reload all data
            loadCustomers();
            loadSuppliers();
            loadDeliveries();
            loadPayments();
            loadActivities();
            loadReports();
            loadSettings();
            updateCharts();

            // Add activity
            appData.activities.unshift({
              id: getNextId(appData.activities),
              type: "Note",
              content: "System data restored from backup",
              user: "System",
              time: getCurrentTime(),
            });
            loadActivities();

            alert("Data restored successfully!");
          } catch (err) {
            alert("Error restoring data: Invalid file format");
            console.error(err);
          }
        };

        reader.readAsText(file);
      };

      input.click();
    }

    function checkForUpdates() {
      // Simulate update check
      setTimeout(() => {
        alert("Your system is up to date!");

        // Add activity
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: "Checked for system updates",
          user: "System",
          time: getCurrentTime(),
        });
        loadActivities();
      }, 1000);
    }

    function generateReport() {
      // Simulate report generation
      setTimeout(() => {
        alert("Financial report generated successfully!");

        // Add activity
        appData.activities.unshift({
          id: getNextId(appData.activities),
          type: "Note",
          content: "Generated financial report",
          user: "Admin",
          time: getCurrentTime(),
        });
        loadActivities();
      }, 1000);
    }

    // Helper functions
    function getNextId(items) {
      return items.length > 0
        ? Math.max(...items.map((item) => item.id)) + 1
        : 1;
    }

    function getCurrentTime() {
      return (
        "Today, " +
        new Date().toLocaleTimeString("en-US", {
          hour: "2-digit",
          minute: "2-digit",
        })
      );
    }

    document.querySelectorAll('.chart-actions').forEach(actionGroup => {
      const buttons = actionGroup.querySelectorAll('.chart-btn');
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        });
      });
    });

    // Fix chart button active toggle behavior
    document.querySelectorAll('.chart-actions').forEach(container => {
      container.querySelectorAll('.chart-btn').forEach(button => {
        button.addEventListener('click', () => {
          container.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
        });
      });
    });

    // Fix modal close button functionality
    function closeModal() {
      document.querySelectorAll('.modal-overlay').forEach(modal => {
        modal.style.display = 'none';
      });
    }

    // Attach event listeners for close buttons (ensures all future modals are covered)
    document.addEventListener('click', function (event) {
      if (event.target.matches('.modal-content button') || event.target.matches('.modal-close')) {
        closeModal();
      }
    });

    // Sidebar dropdown accordion behavior
    document.querySelectorAll(".sidebar li.nav-item").forEach(item => {
      item.addEventListener("click", function () {
        const submenu = this.querySelector(".submenu");
        const arrow = this.querySelector(".dropdown-toggle span:last-child");
        const isOpen = submenu && submenu.style.display === "block";
        submenu.style.display = isOpen ? "none" : "block";
        arrow.textContent = isOpen ? "⌃" : "⌄";
      });
    });

    document.addEventListener("DOMContentLoaded", function () {
      const navItems = document.querySelectorAll(".sidebar .nav-item");

      navItems.forEach(item => {
        const toggle = item.querySelector(".dropdown-toggle");
        const submenu = item.querySelector(".submenu");
        const arrow = toggle ? toggle.querySelector("span:last-child") : null;

        if (toggle && submenu && arrow) {
          submenu.style.display = "none"; // Ensure all start closed

          toggle.addEventListener("click", function (e) {
            e.stopPropagation();

            const isOpen = submenu.style.display === "block";

            // Close all others
            document.querySelectorAll(".sidebar .submenu").forEach(sub => sub.style.display = "none");
            document.querySelectorAll(".sidebar .dropdown-toggle span:last-child").forEach(a => a.textContent = "⌃");

            // Toggle current
            submenu.style.display = isOpen ? "none" : "block";
            arrow.textContent = isOpen ? "⌃" : "⌄";
          });
        }
      });
    });
  </script>
  <script>
    function applyTheme(mode) {
      const html = document.documentElement;
      html.classList.toggle('dark-mode', mode === 'dark');
      localStorage.setItem('theme', mode);
      const icon = document.querySelector('#theme-toggle i');
      if (icon) {
        icon.className = mode === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
      }
      const label = document.getElementById("theme-mode-label");
      if (label) {
        label.textContent = mode === "dark" ? "Dark Mode" : "Light Mode";
        label.style.color = mode === "dark" ? "var(--dark)" : "var(--text)";
      }
      const toggleCheckbox = document.getElementById("theme-mode");
      if (toggleCheckbox) {
        toggleCheckbox.checked = (mode === 'dark');
      }
    }

    function toggleTheme() {
      const isDark = document.documentElement.classList.contains("dark-mode");
      applyTheme(isDark ? "light" : "dark");
    }

    function toggleThemeMode() {
      document.body.classList.toggle(
        "dark-mode",
        document.getElementById("theme-mode").checked
      );
      appData.settings.darkMode =
        document.getElementById("theme-mode").checked;
      updateThemeModeLabel();
      updateCharts();
    }

    document.addEventListener("DOMContentLoaded", () => {
      const savedTheme = localStorage.getItem("theme") || "light";
      applyTheme(savedTheme);

      const toggleBtn = document.getElementById("theme-toggle");
      if (toggleBtn) {
        toggleBtn.addEventListener("click", toggleTheme);
      }

      const themeCheckbox = document.getElementById("theme-mode");
      if (themeCheckbox) {
        themeCheckbox.addEventListener("change", () => {
          applyTheme(themeCheckbox.checked ? "dark" : "light");
        });
      }
    });
  </script>

<script>
  // Close modal on clicking the X button
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.modal-close').forEach(button => {
      button.addEventListener('click', () => {
        const modal = button.closest('.modal');
        if (modal) modal.style.display = 'none';
      });
    });

    // Optional: close modal on clicking outside modal content
    document.querySelectorAll('.modal').forEach(modal => {
      modal.addEventListener('click', e => {
        if (e.target === modal) modal.style.display = 'none';
      });
    });
  });
</script>

</body>
</html>